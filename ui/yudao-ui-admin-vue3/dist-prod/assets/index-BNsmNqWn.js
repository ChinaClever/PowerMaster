import{d as ee,u as ae,e as d,f as le,aU as te,o as k,n as K,w as i,j as r,t as y,a,k as o,l as m,V as ne,ax as L,s as E,c as I,I as N,F as oe,p as ie,q as re,A as se,O as de,Z as ue,_ as pe,Q as ce,D as me,G as ye,R as ge,J as ve,K as fe}from"./index-mcOGIq4g.js";import{_ as he}from"./CommonMenu-CxUjeIT-.js";import{E as ke}from"./el-empty-Bl_qCsZJ.js";import{_ as _e}from"./index.vue_vue_type_script_setup_true_lang-DcNux-x9.js";import{_ as xe}from"./dn-BqCJhieo.js";import{I as S}from"./index-DA5JCs6I.js";import{_ as Ee}from"./_plugin-vue_export-helper-BCo6x5W8.js";import"./ContentWrap.vue_vue_type_script_setup_true_lang-BHQCcaX3.js";import"./el-card-FPJq94NZ.js";import"./NavTree-CcS5UKLK.js";import"./index-BFNvSS9e.js";const U=_=>(ve("data-v-57ea0bcd"),_=_(),fe(),_),be={class:"navInfo"},qe={class:"header"},Ce=U(()=>r("div",null,"\u7528\u80FD\u6700\u5927\u67DC\u5217",-1)),we={style:{"margin-left":"25px"}},We={class:"dataShow"},ze={class:"matrixContainer"},Ie={class:"content"},Ne={class:"info"},Se=U(()=>r("img",{class:"count_img",alt:"",src:xe},null,-1)),Ge={class:"room"},Me=["onClick"],Fe=Ee(ee({__name:"index",setup(_){const{push:Z}=ae(),b=d(null),q=d(null),C=d(null),w=d(!1),j=d(!0);d([]);const v=d([]),g=d(0),A=d([]),l=le({pageNo:1,pageSize:24}),G=d([]),M=d(0),W=d([24,36,48]),p=d(0),c=async(t=!1)=>{w.value=!0,t&&(l.pageNo=1);try{const e=await S.getEqPage({pageNo:l.pageNo,pageSize:l.pageSize,cabinetIds:j.value?null:A.value,roomIds:l.roomIds,runStatus:[],pduBox:0,name:l.name,timeGranularity:l.timeGranularity});e.list&&(v.value=e.list.map(n=>({id:n.id,location:n.location?n.location:n.devKey,local:n.location,yesterdayEq:n.yesterdayEq?n.yesterdayEq.toFixed(1):"0.0",lastWeekEq:n.lastWeekEq?n.lastWeekEq.toFixed(1):"0.0",lastMonthEq:n.lastMonthEq?n.lastMonthEq.toFixed(1):"0.0",status:n.runStatus})),M.value=e.total)}finally{w.value=!1}},F=t=>{g.value!=t&&(g.value=t,t==0?(l.pageSize=24,W.value=[24,36,48]):(l.pageSize=15,W.value=[15,25,30,50,100]),c(!0))},B=async t=>{if(t.length==0)return l.roomIds=null,void c(!0);const e=[];var n=!1;t.forEach(f=>{e.push(f.id),n=!0}),l.roomIds=n?e:[-1],c(!0)},V=(t,e,n)=>{Z({path:"/room/roomenergydetail",state:{roomId:t,id:e,location:n}})};function P(){return{backgroundColor:"#eee"}}function R(t){l.pageSize=t,c(!0)}function D(t){l.pageNo=t,c(!1)}function z(t){l.timeGranularity!=t&&(l.timeGranularity=="yesterday"?p.value=1:l.timeGranularity=="lastWeek"?p.value=2:l.timeGranularity=="lastMonth"&&(p.value=3),l.timeGranularity=t,c(!0))}return te(()=>{(async()=>(await S.getMaxEq()).forEach(t=>{t.type==0?b.value=t.roomName:t.type==1?q.value=t.roomName:t.type==2&&(C.value=t.roomName)}))(),c()}),async function(){const t=await S.getRoomList();G.value=t.map(e=>({id:e.id,name:e.roomName,children:[]}))}(),(t,e)=>{const n=se,f=de,J=ue,x=pe,O=ce,h=me,Q=ye,T=_e,X=ke,$=he,H=ge;return k(),K($,{dataList:a(G),onCheck:B,navTitle:"\u673A\u623F\u7528\u80FD"},{NavInfo:i(()=>[r("div",be,[r("div",qe,[Ce,r("div",null,"\u6628\u65E5\uFF1A"+y(a(b)==null?"\u65E0\u6570\u636E":a(b)),1),r("div",null,"\u4E0A\u5468\uFF1A"+y(a(q)==null?"\u65E0\u6570\u636E":a(q)),1),r("div",null,"\u4E0A\u6708\uFF1A"+y(a(C)==null?"\u65E0\u6570\u636E":a(C)),1)])])]),ActionBar:i(()=>[o(O,{class:"-mb-15px",model:a(l),inline:!0,"label-width":"68px"},{default:i(()=>[o(f,{label:"\u7528\u80FD\u6392\u5E8F","label-width":"100px",style:{"margin-left":"-30px"}},{default:i(()=>[o(n,{onClick:e[0]||(e[0]=u=>{z("yesterday"),p.value=1}),type:a(p)==1?"primary":""},{default:i(()=>[m(" \u6628\u65E5 ")]),_:1},8,["type"]),o(n,{onClick:e[1]||(e[1]=u=>{z("lastWeek"),p.value=2}),type:a(p)==2?"primary":""},{default:i(()=>[m(" \u4E0A\u5468 ")]),_:1},8,["type"]),o(n,{onClick:e[2]||(e[2]=u=>{z("lastMonth"),p.value=3}),type:a(p)==3?"primary":""},{default:i(()=>[m(" \u4E0A\u6708 ")]),_:1},8,["type"])]),_:1}),r("div",we,[o(f,{label:"\u673A\u623F\u540D\u79F0",prop:"name"},{default:i(()=>[o(J,{modelValue:a(l).name,"onUpdate:modelValue":e[3]||(e[3]=u=>a(l).name=u),placeholder:"\u8BF7\u8F93\u5165\u673A\u623F\u540D\u79F0",clearable:"",class:"!w-160px",height:"35",onKeydown:e[4]||(e[4]=ne(L(u=>c(!0),["prevent"]),["enter"]))},null,8,["modelValue"])]),_:1}),o(f,null,{default:i(()=>[o(n,{style:{"margin-left":"12px"},onClick:e[5]||(e[5]=u=>c(!0))},{default:i(()=>[o(x,{icon:"ep:search"}),m("\u641C\u7D22")]),_:1}),o(n,{onClick:e[6]||(e[6]=u=>(p.value=0,l.timeGranularity=null,l.name=null,void c(!0))),style:{width:"70px"}},{default:i(()=>[o(x,{icon:"ep:refresh",class:"mr-5px"}),m(" \u91CD\u7F6E")]),_:1})]),_:1})]),o(f,{style:{"margin-left":"auto"}},{default:i(()=>[o(n,{onClick:e[7]||(e[7]=u=>F(0)),type:a(g)?"":"primary"},{default:i(()=>[o(x,{icon:"ep:grid",style:{"margin-right":"8px"}}),m("\u9635\u5217\u6A21\u5F0F")]),_:1},8,["type"]),o(n,{onClick:e[8]||(e[8]=u=>F(1)),type:a(g)?"primary":""},{default:i(()=>[o(x,{icon:"ep:expand",style:{"margin-right":"8px"}}),m("\u8868\u683C\u6A21\u5F0F")]),_:1},8,["type"])]),_:1})]),_:1},8,["model"])]),Content:i(()=>{var u;return[E((k(),I("div",null,[E(r("div",We,[E(o(Q,{data:a(v),stripe:"",border:!0,"header-cell-style":P},{default:i(()=>[o(h,{label:"\u5E8F\u53F7",width:"100px",align:"center"},{default:i(s=>[m(y(s.$index+(a(l).pageNo-1)*a(l).pageSize+1),1)]),_:1}),o(h,{prop:"location",label:"\u4F4D\u7F6E",align:"center"}),o(h,{prop:"yesterdayEq",label:"\u6628\u65E5\u7528\u80FD(kW\xB7h)",align:"center"}),o(h,{prop:"lastWeekEq",label:"\u4E0A\u5468\u7528\u80FD(kW\xB7h)",align:"center"}),o(h,{prop:"lastMonthEq",label:"\u4E0A\u6708\u7528\u80FD(kW\xB7h)",align:"center"}),o(h,{label:"\u8BE6\u60C5",align:"center",width:"100px"},{default:i(s=>[o(n,{type:"primary",onClick:Y=>V(s.row.roomId,s.row.id,s.row.location)},{default:i(()=>[m("\u8BE6\u60C5")]),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data"]),[[N,a(g)==1]]),E(r("div",ze,[(k(!0),I(oe,null,ie(a(v),s=>(k(),I("div",{class:"item",key:s.key},[r("div",Ie,[r("div",Ne,[r("div",null,"\u6628\u65E5\u7528\u80FD\uFF1A"+y(s.yesterdayEq)+"kW\xB7h",1),r("div",null,"\u4E0A\u5468\u7528\u80FD\uFF1A"+y(s.lastWeekEq)+"kW\xB7h",1),r("div",null,"\u4E0A\u6708\u7528\u80FD\uFF1A"+y(s.lastMonthEq)+"kW\xB7h",1)]),Se]),r("div",Ge,y(s.location),1),r("button",{class:"detail",onClick:L(Y=>V(s.roomId,s.id,s.location),["prevent"])},"\u8BE6\u60C5",8,Me)]))),128))],512),[[N,a(g)==0&&((u=a(v))==null?void 0:u.length)]])],512),[[N,a(v).length>0]]),o(T,{total:a(M),"current-page":a(l).pageNo,"onUpdate:currentPage":e[9]||(e[9]=s=>a(l).pageNo=s),"page-size":a(l).pageSize,"page-sizes":a(W),onSizeChange:R,onCurrentChange:D},null,8,["total","current-page","page-size","page-sizes"]),a(v).length==0&&a(g)==0?(k(),K(X,{key:0,description:"\u6682\u65E0\u6570\u636E","image-size":300})):re("",!0)])),[[H,a(w)]])]}),_:1},8,["dataList"])}}}),[["__scopeId","data-v-57ea0bcd"]]);export{Fe as default};
