import{d as _l,u as Dl,f as se,e as f,g as Re,aj as Ml,h as Fl,i as Vl,o as s,c as w,k as u,w as d,j as p,l as c,a as o,m as ae,F as T,p as X,q as x,v as Y,n as V,s as Ue,ax as He,t as v,ao as Nl,b8 as Pe,N as Il,A as Bl,_ as Sl,D as Tl,G as Rl,Z as Ul,O as Hl,b9 as Pl,ba as zl,bb as El,aA as $l,Q as Xl,B as Yl,R as Ol,a0 as ze,J as jl,K as ql,S as Jl,aR as Kl}from"./index-mcOGIq4g.js";import{_ as Wl}from"./index.vue_vue_type_script_setup_true_lang-DcNux-x9.js";import{E as Zl}from"./el-text-BVz5ES0N.js";import{E as Gl}from"./el-card-FPJq94NZ.js";import{d as Ql}from"./vuedraggable.umd-DnsY9z5D.js";import{_ as ea}from"./layoutForm.vue_vue_type_script_setup_true_lang-ldmw6Gf0.js";import{M as B}from"./index-BpryKTaJ.js";import{u as la}from"./useMessage-CGTQbR_M.js";import{_ as aa}from"./_plugin-vue_export-helper-BCo6x5W8.js";import"./index-BFNvSS9e.js";import"./Dialog.vue_vue_type_style_index_0_lang-BHwm1lq5.js";const A=N=>(jl("data-v-e01d1f69"),N=N(),ql(),N),ta={class:"toolbar"},ia={key:0,style:{display:"flex","align-items":"center"}},oa={class:"status"},na={style:{display:"flex","align-items":"center"}},ra={style:{display:"flex","justify-content":"flex-end",margin:"3px",width:"100%"}},ua=["onDblclick"],da=A(()=>p("br",null,null,-1)),sa=A(()=>p("br",null,null,-1)),ca=A(()=>p("br",null,null,-1)),ma=A(()=>p("br",null,null,-1)),pa=A(()=>p("br",null,null,-1)),va=A(()=>p("br",null,null,-1)),ya=A(()=>p("br",null,null,-1)),ha=A(()=>p("br",null,null,-1)),fa=A(()=>p("br",null,null,-1)),ga=A(()=>p("br",null,null,-1)),ba=A(()=>p("br",null,null,-1)),wa=A(()=>p("br",null,null,-1)),xa={key:0},Ca={key:1},Aa={key:2},ka={key:3},La={key:4},_a=["onDblclick"],Da=A(()=>p("br",null,null,-1)),Ma=A(()=>p("br",null,null,-1)),Fa=A(()=>p("br",null,null,-1)),Va=A(()=>p("br",null,null,-1)),Na=A(()=>p("br",null,null,-1)),Ia=A(()=>p("br",null,null,-1)),Ba=A(()=>p("br",null,null,-1)),Sa=A(()=>p("br",null,null,-1)),Ta=A(()=>p("br",null,null,-1)),Ra=A(()=>p("br",null,null,-1)),Ua=A(()=>p("br",null,null,-1)),Ha=A(()=>p("br",null,null,-1)),Pa={key:0},za={key:1},Ea={key:2},$a={key:3},Xa={key:4},Ya={style:{"margin-bottom":"5px"}},Oa={class:"double-formitem"},ja={style:{"margin-bottom":"10px"}},qa={class:"double-formitem"},Ja={style:{"margin-bottom":"5px"}},Ka={class:"double-formitem"},Wa=A(()=>p("div",{style:{height:"30px"}},null,-1)),Za=aa(_l({__name:"index",props:{containerInfo:{type:Object},isFromHome:{type:Boolean,default:!1}},emits:["backData","getroomid"],setup(N,{emit:Ee}){var Fe;const{push:te}=Dl(),R=la(),U=se({company:void 0,showCol:[1,2,12,13,15,16],pageNo:1,pageSize:24,pageTotal:0}),{containerInfo:z,isFromHome:ce}=N;let me=null;const K=f(!1),k=f(0),pe=f([]),W=f(),$e=f(),Xe=f(),ve=f(1),I=f(1),Z=f(100),G=f(100),ye=f([]),F=f(0),Ye=f(100),O=f(!1),he=f({}),fe=f(),ie=f(),ge=f(),M=f(),be=se({roomDownValIds:(Fe=history==null?void 0:history.state)==null?void 0:Fe.id}),Oe=f(["\u672A\u533A\u5206","\u4E00\u697C","\u4E8C\u697C","\u4E09\u697C","\u56DB\u697C","\u4E94\u697C","\u516D\u697C","\u4E03\u697C","\u516B\u697C","\u4E5D\u697C","\u5341\u697C"]),j=f("\u8D1F\u8F7D\u7387"),r=se({roomName:"",addr:"\u672A\u533A\u5206",row:14,col:18,powerCapacity:0,airPower:null,displayType:0,displayFlag:0,eleAlarmDay:0,eleLimitDay:1e3,eleAlarmMonth:0,eleLimitMonth:1e3}),we=Ee,y=f([]),xe=f([{name:"\u7A7A\u673A\u67DC",color:"#effaff",value:0},{name:"\u6B63\u5E38",color:"#3bbb00",value:1},{name:"\u9884\u8B66",color:"#ffc402",value:2},{name:"\u544A\u8B66",color:"#fa3333",value:3},{name:"\u672A\u7ED1\u5B9A",color:"#05ebfc",value:4},{name:"\u79BB\u7EBF",color:"#7700ff",value:5}]),je=[{value:0,name:"\u673A\u67DC\u8D1F\u8377"},{value:1,name:"\u6709\u529F\u529F\u7387"},{value:2,name:"\u529F\u7387\u56E0\u7D20"},{value:5,name:"\u6628\u65E5\u7528\u80FD"},{value:3,name:"\u6E29\u5EA6"}],qe={id:0,cabinetName:null,roomId:0,roomName:null,aisleId:0,powCapacity:null,cabinetType:null,pduBox:null,isDisabled:null,isDeleted:null,cabinetHeight:0,cabinetUseHeight:0,type:null,company:null,pduIpA:null,casIdA:0,pduIpB:null,casIdB:0,runStatus:0,sensorList:null,rackIndexList:null,outletA:null,outletB:null,usedSpace:0,rackNum:0,freeSpace:0,busIpA:null,busNameA:null,boxNameA:null,barIdA:null,addrA:null,barIdB:null,addrB:null,boxOutletIdA:null,busIpB:null,busNameB:null,boxNameB:null,boxOutletIdB:null,index:4,yesterdayEq:null,boxIndexA:null,boxIndexB:null,eleAlarmDay:null,eleAlarmMonth:null,eleLimitDay:null,eleLimitMonth:null,loadRate:0,lineCurA:null,lineCurB:null,lineVolA:null,lineVolB:null,powerFactor:0,powerFactorA:0,powerFactorB:0,powActive:0,powActiveA:0,powActiveB:0,powReactive:0,powReactiveA:0,powReactiveB:0,powApparent:0,powApparentA:0,powApparentB:0,temData:null,temDataHot:null,cabinetBoxes:null,cabinetPdus:null,rackIndices:null,xCoordinate:0,yCoordinate:0},E=f(!1),q=f(!1),_=f(!1),S=f();f(0);const oe=f(),Ce=f(0),Ae=f(0),ke=f(0),Le=f(0),Je={name:"MachineFill",pull:()=>_.value,put:!1},Ke={name:"MachineBlank",pull:!1,put:l=>{const e=he.value;if(_.value&&e.type==1&&e.amount>1)if(e.direction==1){const t=+l.el.id.split("-")[1],a=+l.el.id.split("-")[0];if(t+e.amount>r.col)return!1;for(let i=0;i<e.amount;i++)if(y.value[a][g.value[t+i]].length||y.value[a+1][g.value[t+i]].length||a>0&&y.value[a-1][g.value[t+i]].length)return!1}else{const t=+l.el.id.split("-")[1],a=+l.el.id.split("-")[0];if(a+e.amount>r.row)return!1;for(let i=0;i<e.amount;i++)if(y.value[a+i][g.value[t]].length||y.value[a+i][g.value[t+1]].length||t>0&&y.value[a+i][g.value[t-1]].length)return!1}return _.value}},C=f({left:"0px",top:"0px",show:!1,lndexX:0,lndexY:0,maxlndexX:0,maxlndexY:0}),Q=async()=>{const l=await B.getRoomList({});l&&l.length&&(pe.value=l,l.find(e=>e.id==k.value)||(be.roomDownValIds==null?k.value=l[0].id:k.value=be.roomDownValIds),we("getroomid",k.value),ne())},ne=async()=>{ll(),O.value=!0;try{const l=await B.getRoomDataNewDetail({id:k.value}),e=l;e.aisleList=e.aisleList==null?[]:e.aisleList,e.cabinetList=e.cabinetList==null?[]:e.cabinetList,M.value=e,ge.value=e.id;const t=[];Object.assign(r,{roomName:e.roomName,row:e.y_length,col:e.x_length,powerCapacity:e.powerCapacity,airPower:e.airPower,addr:e.addr,displayType:e.displayType,displayFlag:e.displayFlag,eleAlarmDay:e.eleAlarmDay,eleLimitDay:e.eleLimitDay,eleAlarmMonth:e.eleAlarmMonth,eleLimitMonth:e.eleLimitMonth}),we("backData",e);for(let a=0;a<e.y_length;a++){const i={};for(let h=0;h<e.x_length;h++)i[H(h)]=[];t.push(i)}e.aisleList.forEach(a=>{a.cabinetList==null&&(a.cabinetList=[]);let i=a.length-a.cabinetList.length;for(let h=0;h<i;h++)a.cabinetList.push(qe);for(let h=0;h<a.length;h++){const L={id:a.id,name:a.aisleName,direction:a.direction=="x"?1:2,type:1,amount:a.cabinetList.length,cabinetList:a.cabinetList,first:!1,originAmount:a.cabinetList.length,originDirection:a.direction=="x"?1:2,powerCapacity:a.powerCapacity,eleAlarmDay:a.eleAlarmDay,eleLimitDay:a.eleLimitDay,eleAlarmMonth:a.eleAlarmMonth,eleLimitMonth:a.eleLimitMonth};h==0&&(L.first=!0),L.direction==1?(t[a.yCoordinate-1][H(a.xCoordinate-1+h)].splice(0,1,L),t[a.yCoordinate][H(a.xCoordinate-1+h)].splice(0,1,{...L,first:!1})):(t[a.yCoordinate-1+h][H(a.xCoordinate-1)].splice(0,1,L),t[a.yCoordinate-1+h][H(a.xCoordinate)].splice(0,1,{...L,first:!1}))}}),e.cabinetList.forEach(a=>{a.xCoordinate>0&&a.yCoordinate>0&&t[a.yCoordinate-1][H(a.xCoordinate-1)].splice(0,1,{...a,name:a.cabinetName,type:2})}),y.value=t,We(l),Ze()}finally{O.value=!1}},We=async l=>{l||(l=await B.getRoomDataDetail({id:k.value})),l.cabinetList&&l.cabinetList.length&&l.cabinetList.forEach(e=>{e.yCoordinate>0&&e.xCoordinate>0&&(y.value[e.yCoordinate-1][g.value[e.xCoordinate-1]][0]={...e,...y.value[e.yCoordinate-1][g.value[e.xCoordinate-1]][0]})}),l.aisleList&&l.aisleList.length&&l.aisleList.forEach(e=>{e.cabinetList.forEach((t,a)=>{const i=y.value[e.yCoordinate-1][g.value[e.xCoordinate-1]][0].cabinetList.findIndex(h=>h.id==t.id);y.value[e.yCoordinate-1][g.value[e.xCoordinate-1]][0].cabinetList[i]={...t,...y.value[e.yCoordinate-1][g.value[e.xCoordinate-1]][0].cabinetList[i]}})})};let ee=0;const _e=l=>{if(I.value==.4&&!l)return;const e=Date.now();e-ee<100||(ee=e,l?I.value+=.2:I.value-=.2,I.value=Math.max(.4,I.value),Z.value=1/I.value*100,G.value=1/I.value*100)},Ze=()=>{ce&&Nl(()=>{const l=setTimeout(()=>{const e=W.value.$el.querySelector(".el-table__body "),t=+e.getBoundingClientRect().width.toFixed()+30,a=+e.getBoundingClientRect().height.toFixed();ve.value=+((z==null?void 0:z.width)/t).toFixed(2),Ye.value=ve.value*a,clearTimeout(l)},10)})},Ge=l=>{k.value=l,I.value=1,Z.value=100,G.value=100,ne()},Qe=()=>{_.value=!1,ne()},De=async()=>{q.value=!0;const l=await B.deletedRoomInfo({pageNo:U.pageNo,pageSize:U.pageSize});ye.value=l.list,U.pageTotal=l.total},el=()=>{q.value=!1},Me=()=>{E.value=!1,K.value=!1},ll=()=>{Object.assign(r,{roomName:"",addr:"\u672A\u533A\u5206",row:14,col:18,powerCapacity:0,airPower:null,displayType:0,displayFlag:0,eleAlarmDay:0,eleLimitDay:1e3,eleAlarmMonth:0,eleLimitMonth:1e3}),j.value="\u8D1F\u8F7D\u7387"},al=()=>{ce?te({path:"/room/topology",state:{id:ge.value}}):_.value=!0},tl=()=>{fe.value=2,Object.assign(r,{roomName:M.value.roomName,row:M.value.y_length,col:M.value.x_length,powerCapacity:M.value.powerCapacity,addr:M.value.addr,airPower:M.value.airPower,displayType:M.value.displayType?1:0,displayFlag:M.value.displayFlag?1:0,eleAlarmDay:M.value.eleAlarmDay,eleLimitDay:M.value.eleLimitDay,eleAlarmMonth:M.value.eleAlarmMonth,eleLimitMonth:M.value.eleLimitMonth}),j.value=M.value.displayType?"PUE":"\u8D1F\u8F7D\u7387",E.value=!0},il=({row:l,columnIndex:e})=>{if(e>0){const t=l[H(e-1)][0];if(t&&t.type&&t.type==1)return t.first?t.direction==1?[2,t.amount]:[t.amount,2]:[0,0];if(t&&t.type&&t.type==2)return[2,1]}return[1,1]},ol=l=>{l.preventDefault();const e=l.currentTarget.getBoundingClientRect(),t=l.clientX-Math.ceil(e.left)+1,a=l.clientY-Math.ceil(e.top)+1,i=l.target.id?l.target.id:l.target.parentNode.id?l.target.parentNode.id:l.target.parentNode.parentNode.id,h=i.split("-")[1],L=i.split("-")[0];i&&(C.value={left:t+"px",top:a+"px",show:!0,lndexX:h,lndexY:L,maxlndexX:r.col-h,maxlndexY:r.row-L})},le=Re(()=>{const l=C.value.lndexX,e=C.value.lndexY;return!(y.value[e][g.value[l]].length>0)}),nl=({from:l})=>{const e=l.id.split("-")[1],t=l.id.split("-")[0],a=y.value[t][g.value[e]][0];a.type==1&&(he.value=a)},rl=({from:l,to:e})=>{if(l.id!=e.id){const t=+e.id.split("-")[1],a=+e.id.split("-")[0],i=y.value[a][g.value[t]][0];if(i.type==1&&i.amount>1){const h=+l.id.split("-")[1],L=+l.id.split("-")[0];i.direction==1?(y.value[L+1][g.value[h]]=[],y.value[a+1][g.value[t]]=[{...i,first:!1}]):(y.value[L][g.value[h+1]]=[],y.value[a][g.value[t+1]]=[{...i,first:!1}]);for(let D=1;D<i.amount;D++)i.direction==1?(y.value[L][g.value[h+D]]=[],y.value[L+1][g.value[h+D]]=[],y.value[a][g.value[t+D]]=[{...i,first:!1}],y.value[a+1][g.value[t+D]]=[{...i,first:!1}]):(y.value[L+D][g.value[h]]=[],y.value[L+D][g.value[h+1]]=[],y.value[a+D][g.value[t]]=[{...i,first:!1}],y.value[a+D][g.value[t+1]]=[{...i,first:!1}])}}},ul=()=>{S.value="grab",C.value.show=!1},dl=l=>{if(S.value=="grab"){S.value="grabbing",Ce.value=l.pageX,Ae.value=l.pageY;const e=W.value.$el.querySelector(".el-scrollbar__wrap");return Le.value=e.scrollTop,ke.value=e.scrollLeft,!1}},sl=l=>{const e=Date.now();if(!(e-ee<100)&&(ee=e,S.value=="grabbing")){const t=l.pageX-Ce.value,a=l.pageY-Ae.value;W.value.setScrollLeft(ke.value-t),W.value.setScrollTop(Le.value-a)}},cl=()=>{S.value=="grabbing"&&(S.value="grab")},ml=()=>{S.value=""},pl=l=>{S.value=="grabbing"&&l.preventDefault()},vl=()=>{ie.value=1,oe.value.open("add",null,C.value),C.value.show=!1},yl=()=>{ie.value=2;const l=C.value.lndexY,e=g.value[C.value.lndexX];oe.value.open("edit",{...y.value[l][e][0]},C.value),C.value.show=!1},re=l=>{let e={};if(l)e=l;else{const t=C.value.lndexY,a=g.value[C.value.lndexX];e=y.value[t][a][0]}e.id?e.type==1?te({path:"/aisle/columnHome",state:{id:e.id,roomId:k.value}}):te({path:"/cabinet/cab/detail",state:{id:e.id}}):R.error(`\u8BE5${e.type==1?"\u67DC\u5217":"\u673A\u67DC"}\u6682\u672A\u4FDD\u5B58\u7ED1\u5B9A\uFF0C\u65E0\u6CD5\u8DF3\u8F6C`)},hl=()=>{const l=C.value.lndexY,e=g.value[C.value.lndexX],t=JSON.parse(JSON.stringify(y.value[l][e][0]));if(t.type&&t.type==1)for(let a=0;a<t.originAmount;a++)t.direction==1?y.value[l][g.value[+C.value.lndexX+a]].splice(0,1):y.value[+l+a][e].splice(0,1);else y.value[l][e].splice(0,1);Pe.confirm("\u786E\u8BA4\u8981\u5220\u9664\u5417\uFF1F","\u63D0\u793A",{confirmButtonText:"\u786E \u8BA4",cancelButtonText:"\u53D6 \u6D88",type:"warning"}).then(async()=>{await B.deletedRoomAisleInfo({id:k.value}),R.success("\u5220\u9664\u6210\u529F")}),C.value.show=!1},fl=async l=>{y.value[C.value.lndexY][g.value[C.value.lndexX]].splice(0,1,{...l,first:!0,originAmount:l.amount,originDirection:l.direction});const e=gl(g.value[C.value.lndexX]),t=C.value.lndexY.toString();let a=null,i="\u4FDD\u5B58\u6210\u529F\uFF01";if(ie.value==2&&(a=l.id,i="\u4FEE\u6539\u6210\u529F\uFF01"),l.type==1){const h=await B.saveRoomAisle({id:a,roomId:k.value,aisleName:l.name,aisleLength:l.amount,xCoordinate:e+1,yCoordinate:parseInt(t)+1,direction:l.direction==1?"x":"y",powerCapacity:l.powerCapacity,eleAlarmDay:l.eleAlarmDay,eleAlarmMonth:l.eleAlarmMonth,eleLimitDay:l.eleLimitDay,eleLimitMonth:l.eleLimitMonth});h==null&&h==""||R.success(i)}else{const h=await B.saveRoomCabinet({id:a,roomId:k.value,cabinetName:l.name,cabinetHeight:l.cabinetHeight,xCoordinate:e+1,yCoordinate:parseInt(t)+1,powerCapacity:l.powerCapacity,eleAlarmDay:l.eleAlarmDay,eleLimitDay:l.eleLimitDay,eleAlarmMonth:l.eleAlarmMonth,eleLimitMonth:l.eleLimitMonth});h==null&&h==""||R.success(i)}},gl=l=>{let e=0;for(let t=0;t<l.length;t++)e+=(l.charCodeAt(t)-65+1)*Math.pow(26,l.length-1-t);return e-1},bl=async()=>{let l=null,e="\u4FDD\u5B58\u6210\u529F\uFF01";fe.value==2&&(l=k.value,e="\u4FEE\u6539\u6210\u529F\uFF01"),j.value==="PUE"?r.displayType=1:r.displayType=0;try{const t=await B.saveRoomDetail({id:l,roomName:r.roomName,addr:r.addr,xLength:r.col,yLength:r.row,powerCapacity:r.powerCapacity,airPower:r.airPower,displayType:r.displayType,displayFlag:r.displayFlag,eleAlarmDay:r.eleAlarmDay,eleAlarmMonth:r.eleAlarmMonth,eleLimitDay:r.eleLimitDay,eleLimitMonth:r.eleLimitMonth});t==null&&t==""||R.success(e),E.value=!1,k.value=t}catch{}Q()},H=l=>l<26?String.fromCharCode(65+l):l<52?`A ${String.fromCharCode(l-26+65)}`:`B ${String.fromCharCode(l-52+65)}`,wl=async()=>{const l=[],e=[];K.value;for(let t=0;t<r.row;t++)for(let a=0;a<r.col;a++){const i=y.value[t][H(a)][0];i&&i.type==1&&i.first?l.push({id:i.id,aisleName:i.name,xCoordinate:a+1,yCoordinate:t+1,direction:i.direction==1?"x":"y",length:i.amount,eleAlarmDay:i.eleAlarmDay,eleLimitDay:i.eleLimitDay,eleAlarmMonth:i.eleAlarmMonth,eleLimitMonth:i.eleLimitMonth}):i&&i.type==2&&e.push({id:i.id,cabinetName:i.name,cabinetHeight:i.cabinetHeight,xCoordinate:a+1,yCoordinate:t+1,eleAlarmDay:i.eleAlarmDay,eleLimitDay:i.eleLimitDay,eleAlarmMonth:i.eleAlarmMonth,eleLimitMonth:i.eleLimitMonth})}try{O.value=!0;const t=await B.saveRoomDetail({id:K.value?"":k.value,roomName:r.roomName,addr:r.addr,xLength:r.col,yLength:r.row,powerCapacity:r.powerCapacity,airPower:r.airPower,displayType:r.displayType,displayFlag:r.displayFlag,eleAlarmDay:r.eleAlarmDay,eleAlarmMonth:r.eleAlarmMonth,eleLimitDay:r.eleLimitDay,eleLimitMonth:r.eleLimitMonth,aisleList:l,cabinetList:e});if(K.value)return k.value=t,Q(),R.success("\u65B0\u5EFA\u6210\u529F\uFF01"),E.value=!1,_.value=!1,void(K.value=!1);_.value=!1,R.success("\u4FDD\u5B58\u6210\u529F\uFF01")}finally{O.value=!1}},g=Re(()=>Object.keys(y.value[0]||{}));return Q(),Ml(()=>z,l=>{l&&(k.value=z==null?void 0:z.roomId)},{immediate:!0}),Fl(()=>{document.addEventListener("mousedown",l=>{const e=l.target;l.button==0&&C.value.show&&e.className!="menu_item"&&(C.value.show=!1)})}),Vl(()=>{window.onresize=null,clearInterval(me),me=null}),(l,e)=>{const t=Jl,a=Il,i=Bl,h=Sl,L=Gl,D=Tl,Ve=Kl,Ne=Rl,ue=Zl,de=Ul,$=Hl,Ie=Pl,xl=zl,Be=El,Cl=$l,Al=Xl,Se=Yl,kl=Wl,Te=Ol;return s(),w(T,null,[u(L,{shadow:"never"},{default:d(()=>[p("div",ta,[N.isFromHome?x("",!0):(s(),w("div",ia,[c(" \u673A\u623F\uFF1A "),u(a,{size:N.isFromHome?"small":"",modelValue:o(k),"onUpdate:modelValue":e[0]||(e[0]=n=>ae(k)?k.value=n:null),placeholder:"\u8BF7\u9009\u62E9",class:"!w-200px",onChange:Ge},{default:d(()=>[(s(!0),w(T,null,X(o(pe),n=>(s(),V(t,{key:n.id,label:n.roomName,value:n.id},null,8,["label","value"]))),128))]),_:1},8,["size","modelValue"])])),p("div",oa,[(s(!0),w(T,null,X(o(xe),n=>(s(),w(T,{key:n.value},[p("div",{class:"box",style:Y({backgroundColor:n.color})},null,4),c(v(n.name),1)],64))),128))]),p("div",{class:"btns",style:Y((N.isFromHome,"flex: 1;display: flex;justify-content: flex-end;margin-right: 10px"))},[(s(),w(T,null,X(je,n=>u(i,{key:n.value,onClick:J=>{return P=n.value,void(F.value=P);var P},type:"primary",size:N.isFromHome?"small":"",plain:o(F)!=n.value},{default:d(()=>[c(v(n.name),1)]),_:2},1032,["onClick","size","plain"])),64))],4),p("div",na,[o(_)?x("",!0):(s(),V(i,{key:0,onClick:al,type:"primary"},{default:d(()=>[c("\u7F16\u8F91")]),_:1})),o(_)?(s(),V(i,{key:1,onClick:De,plain:"",type:"danger"},{default:d(()=>[c("\u5DF2\u5220\u9664")]),_:1})):x("",!0),o(_)?(s(),V(i,{key:2,onClick:Qe,plain:"",type:"primary"},{default:d(()=>[c("\u53D6\u6D88")]),_:1})):x("",!0),o(_)?(s(),V(i,{key:3,onClick:tl,plain:"",type:"primary"},{default:d(()=>[u(h,{size:16,icon:"ep:setting",style:{"margin-right":"5px"}}),c("\u914D\u7F6E")]),_:1})):x("",!0),o(_)?(s(),V(i,{key:4,onClick:wl,plain:"",type:"primary"},{default:d(()=>[c("\u4FDD\u5B58")]),_:1})):x("",!0),p("div",ra,[u(i,{size:"small",onClick:e[1]||(e[1]=n=>{I.value=1,Z.value=100,G.value=100}),circle:""},{default:d(()=>[u(h,{icon:"ep:refresh-right"})]),_:1}),u(i,{size:"small",onClick:e[2]||(e[2]=n=>_e(!1)),circle:""},{default:d(()=>[u(h,{icon:"ep:minus"})]),_:1}),u(i,{size:"small",onClick:e[3]||(e[3]=n=>_e(!0)),circle:""},{default:d(()=>[u(h,{icon:"ep:plus"})]),_:1})])])])]),_:1}),u(L,{shadow:"never"},{default:d(()=>[p("div",{ref_key:"dragTableViewEle",ref:$e,onMousedown:dl,onMousemove:sl,onMouseup:cl,onMouseleave:ml,onSelectstart:pl,style:Y({cursor:`${o(S)}`})},[Ue((s(),w("div",{class:"dragContainer",ref_key:"tableContainer",ref:Xe,style:Y([{},N.isFromHome?`transform-origin: 0 0;height: 50vh;width:${o(Z)}%;`:`height:calc(100vh - 230px);width:${o(Z)}%;`]),onContextmenu:He(ol,["right"])},[o(y).length>0?(s(),V(Ne,{key:0,ref_key:"dragTable",ref:W,class:"dragTable",style:Y({width:"100%",height:`${o(G)}%`,transform:`translateZ(0) scale(${o(I)})`,transformOrigin:"0 0",transition:"none"}),data:o(y),border:"","row-style":{background:"revert"},"span-method":il,"row-class-name":"dragRow"},{default:d(()=>[u(D,{fixed:"",type:"index",width:"60",align:"center",resizable:!1}),(s(!0),w(T,null,X(o(g),(n,J)=>(s(),V(D,{key:J,label:n,"min-width":"60",align:"center",resizable:!1},{default:d(P=>[u(o(Ql),{id:`${P.$index}-${J}`,class:"dragTd",list:P.row[n],itemKey:m=>m.id,tag:"div",group:P.row[n].length>0?Je:Ke,animation:"100",onStart:nl,onEnd:He(rl,["prevent"])},{item:d(({element:m})=>[m&&m.type==2?(s(),w("div",{key:0,class:"normalDrag",onDblclick:b=>re(m)},[m.name?(s(),V(Ve,{key:0,effect:"light"},{content:d(()=>[c(" \u540D\u79F0\uFF1A"+v(m.cabinetName)+" ",1),da,c(" \u8D1F\u8F7D\u7387\uFF1A"+v(m.loadRate?m.loadRate.toFixed(1):"0.0")+"%",1),sa,c(" \u6628\u65E5\u7528\u80FD\uFF1A"+v(m.yesterdayEq||0)+"kW\xB7h",1),ca,c(" \u603B\u6709\u529F\u529F\u7387\uFF1A"+v(m.powActive?m.powActive.toFixed(3):"0.000")+"kW",1),ma,c(" \u603B\u89C6\u5728\u529F\u7387\uFF1A"+v(m.powApparent?m.powApparent.toFixed(3):"0.000")+"kVA",1),pa,c(" \u603B\u65E0\u529F\u529F\u7387\uFF1A"+v(m.powReactive?m.powReactive.toFixed(3):"0.000")+"kVar",1),va,c(" \u603B\u529F\u7387\u56E0\u7D20\uFF1A"+v(m.powerFactor?m.powerFactor.toFixed(2):"0.00"),1),ya,c(" A\u8DEF\u4F9B\u7535\u5360\u6BD4\uFF1A"+v(m.outletA)+" ",1),ha,c(" B\u8DEF\u4F9B\u7535\u5360\u6BD4\uFF1A"+v(m.outletB)+" ",1),fa,c(" \u6700\u9AD8\u6E29\u5EA6\uFF1A"+v(m.tem)+"\xB0C",1),ga,c(" \u5DF2\u7528\u7A7A\u95F4\uFF1A"+v(m.usedSpace)+"U",1),ba,c(" \u672A\u7528\u7A7A\u95F4\uFF1A"+v(m.freeSpace)+"U",1),wa]),default:d(()=>[o(F)==0?(s(),w("div",xa,v(m.loadRate?m.loadRate.toFixed(1):"0.0")+"%",1)):x("",!0),o(F)==1?(s(),w("div",Ca,v(m.powActive?m.powActive.toFixed(3):"0.000")+"kW",1)):x("",!0),o(F)==2?(s(),w("div",Aa,v(m.powerFactor?m.powerFactor.toFixed(2):"0.000"),1)):x("",!0),o(F)==3?(s(),w("div",ka,v(m.tem)+"\xB0C",1)):x("",!0),o(F)==4?(s(),w("div",La,v(m.cabinetHeight)+"U",1)):x("",!0)]),_:2},1024)):x("",!0)],40,ua)):m.type==1?(s(),w("div",{key:1,class:ze(m.direction=="1"?"dragChild":"dragChildCol"),onDblclick:b=>re(m)},[m.cabinetList.length>0?(s(!0),w(T,{key:0},X(m.cabinetList,(b,Ll)=>(s(),w("div",{class:ze(b.cabinetName?"dragSon fill":"dragSon"),style:Y({backgroundColor:o(xe)[b.runStatus].color}),key:Ll},[b.id>0?(s(),V(Ve,{key:0,effect:"light"},{content:d(()=>[c(" \u540D\u79F0\uFF1A"+v(b.cabinetName)+" ",1),Da,c(" \u8D1F\u8F7D\u7387\uFF1A"+v(b.loadRate?b.loadRate.toFixed(1):"0.0")+"%",1),Ma,c(" \u6628\u65E5\u7528\u80FD\uFF1A"+v(b.yesterdayEq||0)+"kW\xB7h",1),Fa,c(" \u603B\u6709\u529F\u529F\u7387\uFF1A"+v(b.powActive?b.powActive.toFixed(3):"0.000")+"kW",1),Va,c(" \u603B\u89C6\u5728\u529F\u7387\uFF1A"+v(b.powApparent?b.powApparent.toFixed(3):"0.000")+"kVA",1),Na,c(" \u603B\u65E0\u529F\u529F\u7387\uFF1A"+v(b.powReactive?b.powReactive.toFixed(3):"0.000")+"kVar",1),Ia,c(" \u603B\u529F\u7387\u56E0\u7D20\uFF1A"+v(b.powerFactor?b.powerFactor.toFixed(2):"0.00"),1),Ba,c(" A\u8DEF\u4F9B\u7535\u5360\u6BD4\uFF1A"+v(b.outletA)+" ",1),Sa,c(" B\u8DEF\u4F9B\u7535\u5360\u6BD4\uFF1A"+v(b.outletB)+" ",1),Ta,c(" \u6700\u9AD8\u6E29\u5EA6\uFF1A"+v(b.tem)+"\xB0C",1),Ra,c(" \u5DF2\u7528\u7A7A\u95F4\uFF1A"+v(b.usedSpace)+"U",1),Ua,c(" \u672A\u7528\u7A7A\u95F4\uFF1A"+v(b.freeSpace)+"U",1),Ha]),default:d(()=>[o(F)==0?(s(),w("div",Pa,v((b.loadRate,n))+"%",1)):x("",!0),o(F)==1?(s(),w("div",za,v(b.powActive?b.powActive.toFixed(0):"0")+"kW",1)):x("",!0),o(F)==2?(s(),w("div",Ea,v(b.powerFactor?b.powerFactor.toFixed(2):"0.000"),1)):x("",!0),o(F)==3?(s(),w("div",$a,v(b.tem)+"\xB0C",1)):x("",!0),o(F)==4?(s(),w("div",Xa,v(b.cabinetHeight)+"U",1)):x("",!0)]),_:2},1024)):x("",!0)],6))),128)):(s(!0),w(T,{key:1},X(m.amount,b=>(s(),w("div",{class:"dragSon",key:b},v(b),1))),128))],42,_a)):x("",!0)]),_:2},1032,["id","list","itemKey","group"])]),_:2},1032,["label"]))),128))]),_:1},8,["style","data"])):x("",!0),o(C).show?(s(),w("div",{key:1,class:"menu",style:Y({left:`${o(C).left}`,top:`${o(C).top}`})},[o(_)?x("",!0):(s(),w("div",{key:0,class:"menu_item",onClick:ul},"\u62D6\u62FD")),o(le)&&o(_)?(s(),w("div",{key:1,class:"menu_item",onClick:vl},"\u65B0\u589E")):x("",!0),!o(le)&&o(_)?(s(),w("div",{key:2,class:"menu_item",onClick:yl},"\u7F16\u8F91")):x("",!0),!o(le)&&o(_)?(s(),w("div",{key:3,class:"menu_item",onClick:e[4]||(e[4]=n=>re(!1))},"\u67E5\u770B")):x("",!0),!o(le)&&o(_)?(s(),w("div",{key:4,class:"menu_item",onClick:hl},"\u5220\u9664")):x("",!0)],4)):x("",!0)],36)),[[Te,o(O)]])],36)]),_:1}),u(ea,{ref_key:"machineForm",ref:oe,onSuccess:fl},null,512),u(Se,{modelValue:o(E),"onUpdate:modelValue":e[13]||(e[13]=n=>ae(E)?E.value=n:null),title:"\u673A\u623F\u914D\u7F6E",width:"30%","before-close":Me},{footer:d(()=>[u(i,{onClick:Me},{default:d(()=>[c("\u53D6 \u6D88")]),_:1}),u(i,{type:"primary",onClick:bl},{default:d(()=>[c("\u786E \u5B9A")]),_:1})]),default:d(()=>[u(Al,null,{default:d(()=>[p("div",Ya,[u(ue,null,{default:d(()=>[c("\u673A\u623F")]),_:1})]),p("div",Oa,[u($,{label:"\u540D\u79F0","label-width":"90"},{default:d(()=>[u(de,{modelValue:o(r).roomName,"onUpdate:modelValue":e[5]||(e[5]=n=>o(r).roomName=n),placeholder:"\u8BF7\u8F93\u5165"},null,8,["modelValue"])]),_:1}),u($,{label:"\u697C\u5C42",prop:"type","label-width":"90"},{default:d(()=>[u(a,{modelValue:o(r).addr,"onUpdate:modelValue":e[6]||(e[6]=n=>o(r).addr=n),placeholder:"\u8BF7\u9009\u62E9"},{default:d(()=>[(s(!0),w(T,null,X(o(Oe),(n,J)=>(s(),V(t,{key:J,label:n,value:n},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1})]),p("div",ja,[u(ue,null,{default:d(()=>[c("\u5730\u7816\uFF08\u5730\u7816\u630960CM*60CM\uFF09")]),_:1})]),p("div",qa,[u($,{label:"\u884C\u6570","label-width":"90"},{default:d(()=>[u(Ie,{modelValue:o(r).row,"onUpdate:modelValue":e[7]||(e[7]=n=>o(r).row=n),min:1,max:100,"controls-position":"right",placeholder:"\u8BF7\u8F93\u5165"},null,8,["modelValue"])]),_:1}),u($,{label:"\u5217\u6570","label-width":"90"},{default:d(()=>[u(Ie,{modelValue:o(r).col,"onUpdate:modelValue":e[8]||(e[8]=n=>o(r).col=n),min:1,max:70,"controls-position":"right",placeholder:"\u8BF7\u8F93\u5165"},null,8,["modelValue"])]),_:1})]),p("div",Ja,[u(ue,null,{default:d(()=>[c("\u5BB9\u91CF")]),_:1})]),u($,{label:"\u673A\u623F\u603B\u7535\u529B\u5BB9\u91CF","label-width":"160"},{default:d(()=>[u(de,{modelValue:o(r).powerCapacity,"onUpdate:modelValue":e[9]||(e[9]=n=>o(r).powerCapacity=n),placeholder:"\u8BF7\u8F93\u5165"},{append:d(()=>[c("kVA")]),_:1},8,["modelValue"])]),_:1}),u($,{label:"\u975EIT\u8BBE\u5907\u603B\u989D\u5B9A\u529F\u7387","label-width":"160"},{default:d(()=>[u(de,{modelValue:o(r).airPower,"onUpdate:modelValue":e[10]||(e[10]=n=>o(r).airPower=n),placeholder:"\u5305\u62EC\u5236\u51B7\u7CFB\u7EDF\uFF08\u5982\u7A7A\u8C03\u3001\u51B7\u6E90\u8BBE\u5907\u3001\u65B0\u98CE\u7CFB\u7EDF\u7B49\uFF09"},{append:d(()=>[c("kVA")]),_:1},8,["modelValue"])]),_:1}),p("div",Ka,[u($,{label:"\u663E\u793A\u9009\u62E9","label-width":"90",style:{"padding-top":"15px"}},{default:d(()=>[u(xl,{modelValue:o(r).displayFlag,"onUpdate:modelValue":e[11]||(e[11]=n=>o(r).displayFlag=n),"active-value":1,"inactive-value":0},null,8,["modelValue"])]),_:1}),u(Cl,{modelValue:o(j),"onUpdate:modelValue":e[12]||(e[12]=n=>ae(j)?j.value=n:null),size:"large",style:{"margin-left":"15px"}},{default:d(()=>[u(Be,{label:"\u8D1F\u8F7D\u7387",value:"\u8D1F\u8F7D\u7387"}),u(Be,{label:"PUE",value:"PUE"})]),_:1},8,["modelValue"])])]),_:1})]),_:1},8,["modelValue"]),u(Se,{modelValue:o(q),"onUpdate:modelValue":e[16]||(e[16]=n=>ae(q)?q.value=n:null),title:"\u6062\u590D\u673A\u623F","before-close":el},{default:d(()=>[Ue((s(),V(Ne,{data:o(ye),stripe:!0,"show-overflow-tooltip":!0,border:!0},{default:d(()=>[u(D,{label:"\u7F16\u53F7","min-width":"110",align:"center"},{default:d(n=>[p("div",null,v(n.row.id),1)]),_:1}),u(D,{label:"\u673A\u623F\u540D\u79F0","min-width":"110",align:"center"},{default:d(n=>[p("div",null,v(n.row.roomName),1)]),_:1}),u(D,{label:"\u5220\u9664\u65E5\u671F","min-width":"110",align:"center"},{default:d(n=>[c(v(new Date(n.row.updateTime).toISOString().slice(0,10)),1)]),_:1}),u(D,{label:"\u64CD\u4F5C",align:"center"},{default:d(n=>[u(i,{link:"",type:"danger",onClick:J=>(async P=>{Pe.confirm("\u786E\u8BA4\u6062\u590D\u673A\u623F\u5417\uFF1F","\u63D0\u793A",{confirmButtonText:"\u786E \u8BA4",cancelButtonText:"\u53D6 \u6D88",type:"warning"}).then(async()=>{const m=await B.restoreRoomInfo({id:P});m==null&&m==""||(q.value=!1),R.success("\u6062\u590D\u6210\u529F"),Q()})})(n.row.id)},{default:d(()=>[c(" \u6062\u590D\u673A\u623F ")]),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data"])),[[Te,o(O)]]),u(kl,{total:o(U).pageTotal,page:o(U).pageNo,"onUpdate:page":e[14]||(e[14]=n=>o(U).pageNo=n),limit:o(U).pageSize,"onUpdate:limit":e[15]||(e[15]=n=>o(U).pageSize=n),onPagination:De},null,8,["total","page","limit"]),Wa]),_:1},8,["modelValue"])],64)}}}),[["__scopeId","data-v-e01d1f69"]]);export{Za as default};
