import{d as I,e as d,f as N,aj as S,o as v,n as y,w as o,k as t,l as A,a as l,s as Z,q as _,j as c,m as B,x as O,S as Q,N as R,O as z,Z as E,b9 as G,ba as J,Q as K,A as P,R as T}from"./index-mcOGIq4g.js";import{_ as W}from"./Dialog.vue_vue_type_style_index_0_lang-BHwm1lq5.js";import{u as $}from"./useMessage-CGTQbR_M.js";const ee={style:{display:"flex"}},ae={style:{flex:"1"}},le={style:{flex:"1"}},te={style:{display:"flex","justify-content":"space-evenly"}},ue={style:{flex:"1"}},oe={style:{flex:"1"}},ie=I({__name:"layoutForm",emits:["success"],setup(ne,{expose:M,emit:k}){O(),$();const L=d(1),V=d(1),r=d(!1),g=d(""),m=d({}),f=d(!1),D=d(""),e=d({eleAlarmDay:0,eleLimitDay:1e3,eleAlarmMonth:0,eleLimitMonth:1e3,powerCapacity:0,type:1,name:"",cabinetHeight:42,direction:1,amount:12,id:"",cabinetList:[]}),C=N({name:[{required:!0,message:"\u540D\u79F0\u4E0D\u80FD\u4E3A\u7A7A",trigger:"blur"}]}),b=d();M({open:async(i,a,p)=>{if(r.value=!0,g.value=i=="edit"?"\u7F16\u8F91":"\u6DFB\u52A0",D.value=i,m.value=p,j(),a&&a.type==1&&a.amount>1&&a.cabinetList.length>0){const s=a.amount;L.value=s;for(let n=1;n<=s;n++)if(a.cabinetList[s-n].id>0){V.value=a.cabinetList[s-n].index;break}}a&&(e.value=a)}});const H=k,X=async()=>{if(b&&await b.value.validate()){if(e.value.type==1&&e.value.cabinetList.length>0){const i=e.value.amount-L.value;if(i>0)for(let a=0;a<i;a++)e.value.cabinetList.push({id:0,cabinetName:"",runStatus:0});else i<0&&e.value.cabinetList.splice(e.value.amount-1,-i)}f.value=!0;try{r.value=!1,H("success",{...e.value})}catch{}finally{f.value=!1}}},j=()=>{var i;e.value={eleAlarmDay:0,eleLimitDay:1e3,eleAlarmMonth:0,eleLimitMonth:1e3,powerCapacity:0,type:1,name:"",cabinetHeight:42,direction:1,amount:12,id:"",cabinetList:[]},V.value=1,(i=b.value)==null||i.resetFields()};return S(()=>e.value.direction,i=>{i==1&&e.value.amount>m.value.maxlndexX?e.value.amount=m.value.maxlndexX:i==2&&e.value.amount>m.value.maxlndexY&&(e.value.amount=m.value.maxlndexY)}),(i,a)=>{const p=Q,s=R,n=z,h=E,x=G,w=J,F=K,U=P,Y=W,q=T;return v(),y(Y,{modelValue:l(r),"onUpdate:modelValue":a[11]||(a[11]=u=>B(r)?r.value=u:null),title:l(g)},{footer:o(()=>[t(U,{onClick:a[10]||(a[10]=u=>r.value=!1)},{default:o(()=>[A("\u53D6 \u6D88")]),_:1}),t(U,{disabled:l(f),type:"primary",onClick:X},{default:o(()=>[A("\u786E \u5B9A")]),_:1},8,["disabled"])]),default:o(()=>[Z((v(),y(F,{ref_key:"layoutForm",ref:b,model:l(e),rules:l(C),"label-width":"100px",center:""},{default:o(()=>[t(n,{label:"\u7C7B\u578B",prop:"type"},{default:o(()=>[t(s,{modelValue:l(e).type,"onUpdate:modelValue":a[0]||(a[0]=u=>l(e).type=u),placeholder:"\u8BF7\u9009\u62E9\u6D3B\u52A8\u533A\u57DF"},{default:o(()=>[t(p,{label:"\u673A\u67DC\u5217",value:1}),t(p,{label:"\u673A\u67DC",value:2})]),_:1},8,["modelValue"])]),_:1}),t(n,{label:"\u540D\u79F0",prop:"name"},{default:o(()=>[t(h,{modelValue:l(e).name,"onUpdate:modelValue":a[1]||(a[1]=u=>l(e).name=u),placeholder:"\u8BF7\u8F93\u5165"},null,8,["modelValue"])]),_:1}),l(e).type==2?(v(),y(n,{key:0,label:"\u9AD8\u5EA6",prop:"cabinetHeight"},{default:o(()=>[t(h,{modelValue:l(e).cabinetHeight,"onUpdate:modelValue":a[2]||(a[2]=u=>l(e).cabinetHeight=u),modelModifiers:{number:!0},suffixIcon:()=>"U"},null,8,["modelValue"])]),_:1})):_("",!0),l(e).type==1?(v(),y(n,{key:1,label:"\u65B9\u5411",prop:"direction"},{default:o(()=>[t(s,{modelValue:l(e).direction,"onUpdate:modelValue":a[3]||(a[3]=u=>l(e).direction=u),placeholder:"\u8BF7\u9009\u62E9\u6D3B\u52A8\u533A\u57DF"},{default:o(()=>[t(p,{label:"\u6A2A\u5411",value:1}),t(p,{label:"\u7EB5\u5411",value:2})]),_:1},8,["modelValue"])]),_:1})):_("",!0),l(e).type==1?(v(),y(n,{key:2,label:"\u6570\u91CF",prop:"amount"},{default:o(()=>[t(x,{modelValue:l(e).amount,"onUpdate:modelValue":a[4]||(a[4]=u=>l(e).amount=u),min:l(V),max:l(e).direction==1?l(m).maxlndexX:l(m).maxlndexY},null,8,["modelValue","min","max"])]),_:1})):_("",!0),t(n,{label:"\u7535\u529B\u5BB9\u91CF"},{default:o(()=>[t(h,{modelValue:l(e).powerCapacity,"onUpdate:modelValue":a[5]||(a[5]=u=>l(e).powerCapacity=u),placeholder:"\u8BF7\u8F93\u5165"},null,8,["modelValue"])]),_:1}),c("div",ee,[c("div",ae,[t(n,{label:"\u65E5\u7528\u80FD\u544A\u8B66","label-width":"100"},{default:o(()=>[t(w,{modelValue:l(e).eleAlarmDay,"onUpdate:modelValue":a[6]||(a[6]=u=>l(e).eleAlarmDay=u),"active-value":1,"inactive-value":0},null,8,["modelValue"])]),_:1})]),c("div",le,[t(n,{label:"\u65E5\u7528\u80FD\u9650\u5236","label-width":"100"},{default:o(()=>[t(x,{modelValue:l(e).eleLimitDay,"onUpdate:modelValue":a[7]||(a[7]=u=>l(e).eleLimitDay=u),min:0,max:9999,"controls-position":"right",placeholder:"\u8BF7\u8F93\u5165"},null,8,["modelValue"])]),_:1})])]),c("div",te,[c("div",ue,[t(n,{label:"\u6708\u7528\u80FD\u544A\u8B66","label-width":"100"},{default:o(()=>[t(w,{modelValue:l(e).eleAlarmMonth,"onUpdate:modelValue":a[8]||(a[8]=u=>l(e).eleAlarmMonth=u),"active-value":1,"inactive-value":0},null,8,["modelValue"])]),_:1})]),c("div",oe,[t(n,{label:"\u6708\u7528\u80FD\u9650\u5236","label-width":"100"},{default:o(()=>[t(x,{modelValue:l(e).eleLimitMonth,"onUpdate:modelValue":a[9]||(a[9]=u=>l(e).eleLimitMonth=u),min:0,max:9999,"controls-position":"right",placeholder:"\u8BF7\u8F93\u5165"},null,8,["modelValue"])]),_:1})])])]),_:1},8,["model","rules"])),[[q,l(f)]])]),_:1},8,["modelValue","title"])}}});export{ie as _};
