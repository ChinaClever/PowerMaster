import{d as Q,x as Z,e as d,f as $,o as i,n as c,w as s,k as t,l as k,s as j,a,c as w,F as x,p as S,m as z,O as G,Z as H,b9 as J,S as K,N as P,Q as W,A as Y,R as X}from"./index-mcOGIq4g.js";import{_ as ee}from"./Dialog.vue_vue_type_style_index_0_lang-BHwm1lq5.js";import{E as le}from"./el-tree-select-CP2w2htY.js";import{a as ae,D as oe}from"./dict-Cu4dALpk.js";import{d as te,h as se}from"./tree-Cts6wVCK.js";import{g as re,c as de,u as ue,a as me}from"./index-DaJ-UTR5.js";import{g as ie}from"./index-CTA3ZZij.js";import{C as E}from"./constants-D0aoFN3l.js";import{u as ne}from"./useMessage-CGTQbR_M.js";const pe=Q({name:"SystemDeptForm",__name:"DeptForm",emits:["success"],setup(ce,{expose:q,emit:A}){const{t:v}=Z(),V=ne(),m=d(!1),b=d(""),n=d(!1),h=d(""),o=d({id:void 0,title:"",parentId:void 0,name:void 0,sort:void 0,leaderUserId:void 0,phone:void 0,email:void 0,status:E.ENABLE}),C=$({parentId:[{required:!0,message:"\u4E0A\u7EA7\u90E8\u95E8\u4E0D\u80FD\u4E3A\u7A7A",trigger:"blur"}],name:[{required:!0,message:"\u90E8\u95E8\u540D\u79F0\u4E0D\u80FD\u4E3A\u7A7A",trigger:"blur"}],sort:[{required:!0,message:"\u663E\u793A\u6392\u5E8F\u4E0D\u80FD\u4E3A\u7A7A",trigger:"blur"}],email:[{type:"email",message:"\u8BF7\u8F93\u5165\u6B63\u786E\u7684\u90AE\u7BB1\u5730\u5740",trigger:["blur","change"]}],phone:[{pattern:/^1[3|4|5|6|7|8|9][0-9]\d{8}$/,message:"\u8BF7\u8F93\u5165\u6B63\u786E\u7684\u624B\u673A\u53F7\u7801",trigger:"blur"}],status:[{required:!0,message:"\u72B6\u6001\u4E0D\u80FD\u4E3A\u7A7A",trigger:"blur"}]}),p=d(),f=d(),_=d([]);q({open:async(r,e)=>{if(m.value=!0,b.value=v("action."+r),h.value=r,N(),e){n.value=!0;try{o.value=await re(e)}finally{n.value=!1}}_.value=await ie(),await L()}});const F=A,D=async()=>{if(p&&await p.value.validate()){n.value=!0;try{const r=o.value;h.value==="create"?(await de(r),V.success(v("common.createSuccess"))):(await ue(r),V.success(v("common.updateSuccess"))),m.value=!1,F("success")}finally{n.value=!1}}},N=()=>{var r;o.value={id:void 0,title:"",parentId:void 0,name:void 0,sort:void 0,leaderUserId:void 0,phone:void 0,email:void 0,status:E.ENABLE},(r=p.value)==null||r.resetFields()},L=async()=>{f.value=[];const r=await me();let e={id:0,name:"\u9876\u7EA7\u90E8\u95E8",children:[]};e.children=se(r),f.value.push(e)};return(r,e)=>{const O=le,u=G,g=H,B=J,y=K,U=P,R=W,I=Y,T=ee,M=X;return i(),c(T,{modelValue:a(m),"onUpdate:modelValue":e[8]||(e[8]=l=>z(m)?m.value=l:null),title:a(b)},{footer:s(()=>[t(I,{type:"primary",onClick:D},{default:s(()=>[k("\u786E \u5B9A")]),_:1}),t(I,{onClick:e[7]||(e[7]=l=>m.value=!1)},{default:s(()=>[k("\u53D6 \u6D88")]),_:1})]),default:s(()=>[j((i(),c(R,{ref_key:"formRef",ref:p,model:a(o),rules:a(C),"label-width":"80px"},{default:s(()=>[t(u,{label:"\u4E0A\u7EA7\u90E8\u95E8",prop:"parentId"},{default:s(()=>[t(O,{modelValue:a(o).parentId,"onUpdate:modelValue":e[0]||(e[0]=l=>a(o).parentId=l),data:a(f),props:a(te),"check-strictly":"","default-expand-all":"",placeholder:"\u8BF7\u9009\u62E9\u4E0A\u7EA7\u90E8\u95E8","value-key":"deptId"},null,8,["modelValue","data","props"])]),_:1}),t(u,{label:"\u90E8\u95E8\u540D\u79F0",prop:"name"},{default:s(()=>[t(g,{modelValue:a(o).name,"onUpdate:modelValue":e[1]||(e[1]=l=>a(o).name=l),placeholder:"\u8BF7\u8F93\u5165\u90E8\u95E8\u540D\u79F0"},null,8,["modelValue"])]),_:1}),t(u,{label:"\u663E\u793A\u6392\u5E8F",prop:"sort"},{default:s(()=>[t(B,{modelValue:a(o).sort,"onUpdate:modelValue":e[2]||(e[2]=l=>a(o).sort=l),min:0,"controls-position":"right"},null,8,["modelValue"])]),_:1}),t(u,{label:"\u8D1F\u8D23\u4EBA",prop:"leaderUserId"},{default:s(()=>[t(U,{modelValue:a(o).leaderUserId,"onUpdate:modelValue":e[3]||(e[3]=l=>a(o).leaderUserId=l),clearable:"",placeholder:"\u8BF7\u8F93\u5165\u8D1F\u8D23\u4EBA"},{default:s(()=>[(i(!0),w(x,null,S(a(_),l=>(i(),c(y,{key:l.id,label:l.nickname,value:l.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),t(u,{label:"\u8054\u7CFB\u7535\u8BDD",prop:"phone"},{default:s(()=>[t(g,{modelValue:a(o).phone,"onUpdate:modelValue":e[4]||(e[4]=l=>a(o).phone=l),maxlength:"11",placeholder:"\u8BF7\u8F93\u5165\u8054\u7CFB\u7535\u8BDD"},null,8,["modelValue"])]),_:1}),t(u,{label:"\u90AE\u7BB1",prop:"email"},{default:s(()=>[t(g,{modelValue:a(o).email,"onUpdate:modelValue":e[5]||(e[5]=l=>a(o).email=l),maxlength:"50",placeholder:"\u8BF7\u8F93\u5165\u90AE\u7BB1"},null,8,["modelValue"])]),_:1}),t(u,{label:"\u72B6\u6001",prop:"status"},{default:s(()=>[t(U,{modelValue:a(o).status,"onUpdate:modelValue":e[6]||(e[6]=l=>a(o).status=l),clearable:"",placeholder:"\u8BF7\u9009\u62E9\u72B6\u6001"},{default:s(()=>[(i(!0),w(x,null,S(a(ae)(a(oe).COMMON_STATUS),l=>(i(),c(y,{key:l.value,label:l.label,value:l.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1},8,["model","rules"])),[[M,a(n)]])]),_:1},8,["modelValue","title"])}}});export{pe as _};
