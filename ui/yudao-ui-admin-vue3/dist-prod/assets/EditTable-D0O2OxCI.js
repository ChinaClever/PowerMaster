import{d as E,u as q,T as A,e as s,h as L,s as M,a,o as O,n as Q,w as l,k as e,m as S,l as p,x as U,L as j,M as B,A as F,O as G,Q as z,R as D}from"./index-mcOGIq4g.js";import{_ as H}from"./ContentWrap.vue_vue_type_script_setup_true_lang-BHQCcaX3.js";import{u as J}from"./tagsView-DSqG0Q6D.js";import{_ as K}from"./BasicInfoForm.vue_vue_type_script_setup_true_lang-C5OJdt88.js";import{_ as N}from"./ColumInfoForm.vue_vue_type_script_setup_true_lang-DGZo0k_1.js";import{_ as P}from"./GenerateInfoForm.vue_vue_type_script_setup_true_lang-F6oHigys.js";import{g as W,u as X}from"./index-CRRaXpPV.js";import{u as Y}from"./useMessage-CGTQbR_M.js";import"./el-card-FPJq94NZ.js";import"./formRules-CpfMmool.js";import"./dict.type-Ba2GvGFW.js";import"./el-dropdown-item-YOt6BOHH.js";import"./el-tree-select-CP2w2htY.js";import"./dict-Cu4dALpk.js";import"./tree-Cts6wVCK.js";import"./index-BrAk6oq9.js";const Z=E({name:"InfraCodegenEditTable",__name:"EditTable",setup($){const{t:_}=U(),b=Y(),{push:y,currentRoute:g}=q(),{query:v}=A(),{delView:I}=J(),r=s(!1),m=s("colum"),f=s(),k=s(),i=s(),t=s({table:{},columns:[]}),w=async()=>{var o,u;if(a(t)){await((o=a(f))==null?void 0:o.validate()),await((u=a(i))==null?void 0:u.validate());try{await X(t.value),b.success(_("common.updateSuccess")),c()}catch{}}},c=()=>{I(a(g)),y("/infra/codegen")};return L(()=>{(async()=>{const o=v.id;if(o){r.value=!0;try{t.value=await W(o)}finally{r.value=!1}}})()}),(o,u)=>{const n=j,h=B,d=F,R=G,C=z,V=H,x=D;return M((O(),Q(V,null,{default:l(()=>[e(h,{modelValue:a(m),"onUpdate:modelValue":u[0]||(u[0]=T=>S(m)?m.value=T:null)},{default:l(()=>[e(n,{label:"\u57FA\u672C\u4FE1\u606F",name:"basicInfo"},{default:l(()=>[e(a(K),{ref_key:"basicInfoRef",ref:f,table:a(t).table},null,8,["table"])]),_:1}),e(n,{label:"\u5B57\u6BB5\u4FE1\u606F",name:"colum"},{default:l(()=>[e(a(N),{ref_key:"columInfoRef",ref:k,columns:a(t).columns},null,8,["columns"])]),_:1}),e(n,{label:"\u751F\u6210\u4FE1\u606F",name:"generateInfo"},{default:l(()=>[e(a(P),{ref_key:"generateInfoRef",ref:i,table:a(t).table,columns:a(t).columns},null,8,["table","columns"])]),_:1})]),_:1},8,["modelValue"]),e(C,null,{default:l(()=>[e(R,{style:{float:"right"}},{default:l(()=>[e(d,{loading:a(r),type:"primary",onClick:w},{default:l(()=>[p("\u4FDD\u5B58")]),_:1},8,["loading"]),e(d,{onClick:c},{default:l(()=>[p("\u8FD4\u56DE")]),_:1})]),_:1})]),_:1})]),_:1})),[[x,a(r)]])}}});export{Z as default};
