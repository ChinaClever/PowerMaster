import{d as X,u as Y,e as p,f as aa,aU as V,o as h,n as W,w as s,j as r,t as u,a as t,k as n,l as d,s as ea,c as x,F as la,p as ta,ax as ia,q as S,A as na,O as oa,Z as sa,_ as ra,Q as da,D as pa,G as ua,R as ca,J as ma,K as ya}from"./index-mcOGIq4g.js";import{_ as ga}from"./CommonMenu-CxUjeIT-.js";import{E as ha}from"./el-empty-Bl_qCsZJ.js";import{_ as fa}from"./index.vue_vue_type_script_setup_true_lang-DcNux-x9.js";import{E as va}from"./el-text-BVz5ES0N.js";import{_ as ka}from"./dn-BqCJhieo.js";import{I as M}from"./index-Bla3Qadp.js";import{_ as _a}from"./_plugin-vue_export-helper-BCo6x5W8.js";import"./ContentWrap.vue_vue_type_script_setup_true_lang-BHQCcaX3.js";import"./el-card-FPJq94NZ.js";import"./NavTree-CcS5UKLK.js";import"./index-BFNvSS9e.js";const B=k=>(ma("data-v-7ccaf5c8"),k=k(),ya(),k),Ea={class:"navInfo"},xa={class:"header"},qa=B(()=>r("div",null,"\u7528\u80FD\u6700\u5927\u67DC\u5217",-1)),wa={style:{"margin-left":"50px"}},ba={key:0,class:"matrixContainer"},Ca={class:"content"},Na={class:"info"},za=B(()=>r("img",{class:"count_img",alt:"",src:ka},null,-1)),Ia={class:"room"},Wa=["onClick"],Sa=_a(X({__name:"index",setup(k){const{push:K}=Y(),g=p(0),q=p(!1),G=p(!0),F=p([]),v=p([]),y=p(0),L=p([]),w=p([24,36,48]),b=p(null),C=p(null),N=p(null),i=aa({name:void 0,pageNo:1,pageSize:24,pageTotal:0,timeGranularity:null,cabinetIds:[]}),m=async(a=!1)=>{q.value=!0,a&&(i.pageNo=1);try{const o=await M.getEqPage({pageNo:i.pageNo,pageSize:i.pageSize,cabinetIds:G.value?null:L.value,aisleIds:i.aisleIds,runStatus:[],pduBox:0,name:i.name,timeGranularity:i.timeGranularity});o.list&&(v.value=o.list.map(e=>({id:e.id,location:e.location?e.location:e.devKey,local:e.location,yesterdayEq:e.yesterdayEq?e.yesterdayEq.toFixed(1):"0.0",lastWeekEq:e.lastWeekEq?e.lastWeekEq.toFixed(1):"0.0",lastMonthEq:e.lastMonthEq?e.lastMonthEq.toFixed(1):"0.0",status:e.runStatus,roomId:e.roomId})),i.pageTotal=o.total,G.value=!1)}finally{q.value=!1}},T=a=>{y.value!=a&&(y.value==0?(i.pageSize=15,w.value=[15,25,30,50,100]):(i.pageSize=24,w.value=[24,36,48]),i.pageNo=1,i.timeGranularity=null,y.value=a,m(!0))},Q=async a=>{if(a.length==0)return i.aisleIds=null,void m(!0);const o=[];var e=!1;a.forEach(c=>{c.type==2&&(o.push(c.id),e=!0)}),i.aisleIds=e?o:[-1],m(!0)},A=(a,o,e)=>{K({path:"/aisle/aislemonitor/aisleenergydetail",state:{roomId:a,id:o,location:e}})};function z(a){i.timeGranularity!=a&&(i.timeGranularity=a,m(!0))}function U(){return{backgroundColor:"#eee"}}function Z(a){i.pageSize=a,i.pageNo=1,m(!0)}function j(a){i.pageNo=a,m(!1)}return V(()=>{(async()=>{const a=await M.getAisleMenu();if(F.value=a,a&&a.length>0){const o=a[0],e=[];o.children.forEach(c=>{c.children.length>0&&c.children.forEach(_=>{e.push(_.id+"-"+_.type)})})}})(),m()}),V(async()=>{(await M.getMaxEq()).forEach(a=>{a.type==0?b.value=a.roomName+"-"+a.aisleName:a.type==1?C.value=a.roomName+"-"+a.aisleName:a.type==2&&(N.value=a.roomName+"-"+a.aisleName)})}),(a,o)=>{const e=na,c=oa,_=sa,E=ra,D=da,f=pa,I=va,J=ua,O=fa,P=ha,R=ga,$=ca;return h(),W(R,{dataList:t(F),onCheck:Q,navTitle:"\u67DC\u5217\u7528\u80FD"},{NavInfo:s(()=>[r("div",Ea,[r("div",xa,[qa,r("div",null,"\u6628\u65E5\uFF1A"+u(t(b)==null?"\u65E0\u6570\u636E":t(b)),1),r("div",null,"\u4E0A\u5468\uFF1A"+u(t(C)==null?"\u65E0\u6570\u636E":t(C)),1),r("div",null,"\u4E0A\u6708\uFF1A"+u(t(N)==null?"\u65E0\u6570\u636E":t(N)),1)])])]),ActionBar:s(()=>[n(D,{class:"-mb-15px",model:t(i),inline:!0,"label-width":"68px"},{default:s(()=>[n(c,{label:"\u7528\u80FD\u6392\u5E8F","label-width":"100px",style:{"margin-left":"-30px"}},{default:s(()=>[n(e,{onClick:o[0]||(o[0]=l=>{z("yesterday"),g.value=1}),type:t(g)==1?"primary":""},{default:s(()=>[d(" \u6628\u65E5 ")]),_:1},8,["type"]),n(e,{onClick:o[1]||(o[1]=l=>{z("lastWeek"),g.value=2}),type:t(g)==2?"primary":""},{default:s(()=>[d(" \u4E0A\u5468 ")]),_:1},8,["type"]),n(e,{onClick:o[2]||(o[2]=l=>{z("lastMonth"),g.value=3}),type:t(g)==3?"primary":""},{default:s(()=>[d(" \u4E0A\u6708 ")]),_:1},8,["type"])]),_:1}),r("div",wa,[n(c,{label:"\u67DC\u5217\u540D\u79F0",prop:"username"},{default:s(()=>[n(_,{modelValue:t(i).name,"onUpdate:modelValue":o[3]||(o[3]=l=>t(i).name=l),placeholder:"\u8BF7\u8F93\u5165\u67DC\u5217\u540D\u79F0",clearable:"",class:"!w-160px",height:"35"},null,8,["modelValue"])]),_:1}),n(c,null,{default:s(()=>[n(e,{style:{"margin-left":"12px"},onClick:o[4]||(o[4]=l=>m(!0))},{default:s(()=>[n(E,{icon:"ep:search"}),d("\u641C\u7D22")]),_:1}),n(e,{onClick:o[5]||(o[5]=l=>{i.timeGranularity=null,i.name=null,m(!0),g.value=0}),style:{width:"70px"}},{default:s(()=>[n(E,{icon:"ep:refresh",class:"mr-5px"}),d(" \u91CD\u7F6E")]),_:1})]),_:1})]),n(c,{style:{"margin-left":"auto"}},{default:s(()=>[n(e,{onClick:o[6]||(o[6]=l=>T(0)),type:t(y)?"":"primary"},{default:s(()=>[n(E,{icon:"ep:grid",style:{"margin-right":"8px"}}),d("\u9635\u5217\u6A21\u5F0F")]),_:1},8,["type"]),n(e,{onClick:o[7]||(o[7]=l=>T(1)),type:t(y)?"primary":""},{default:s(()=>[n(E,{icon:"ep:expand",style:{"margin-right":"8px"}}),d("\u8868\u683C\u6A21\u5F0F")]),_:1},8,["type"])]),_:1})]),_:1},8,["model"])]),Content:s(()=>[ea((h(),x("div",null,[t(y)==0&&t(v).length>0?(h(),x("div",ba,[(h(!0),x(la,null,ta(t(v),l=>(h(),x("div",{class:"item",key:l.key},[r("div",Ca,[r("div",Na,[r("div",null,"\u6628\u65E5\u7528\u80FD\uFF1A"+u(l.yesterdayEq)+"kW\xB7h",1),r("div",null,"\u4E0A\u5468\u7528\u80FD\uFF1A"+u(l.lastWeekEq)+"kW\xB7h",1),r("div",null,"\u4E0A\u6708\u7528\u80FD\uFF1A"+u(l.lastMonthEq)+"kW\xB7h",1)]),za]),r("div",Ia,u(l.location),1),r("button",{class:"detail",onClick:ia(H=>A(l.roomId,l.id,l.location),["prevent"])},"\u8BE6\u60C5",8,Wa)]))),128))])):S("",!0),t(y)==1?(h(),W(J,{key:1,style:{width:"100%",height:"calc(100vh - 215px)"},data:t(v),border:!0,stripe:!0,"header-cell-style":U},{default:s(()=>[n(f,{width:"75",label:"\u5E8F\u53F7",align:"center"},{default:s(l=>[d(u((t(i).pageNo-1)*t(i).pageSize+l.$index+1),1)]),_:1}),n(f,{label:"\u4F4D\u7F6E","min-width":"110",align:"center",prop:"local"}),n(f,{label:"\u6628\u65E5\u7528\u80FD(kW\xB7h)","min-width":"110",align:"center",prop:"yesterdayEq"},{default:s(l=>[n(I,{"line-clamp":"2"},{default:s(()=>[d(u(l.row.yesterdayEq),1)]),_:2},1024)]),_:1}),n(f,{label:"\u4E0A\u5468\u7528\u80FD(kW\xB7h)","min-width":"110",align:"center",prop:"lastWeekEq"},{default:s(l=>[n(I,{"line-clamp":"2"},{default:s(()=>[d(u(l.row.lastWeekEq),1)]),_:2},1024)]),_:1}),n(f,{label:"\u4E0A\u6708\u7528\u80FD(kW\xB7h)","min-width":"110",align:"center",prop:"lastMonthEq"},{default:s(l=>[n(I,{"line-clamp":"2"},{default:s(()=>[d(u(l.row.lastMonthEq),1)]),_:2},1024)]),_:1}),n(f,{label:"\u8BE6\u60C5",width:"120",align:"center",prop:"lastMonthEq"},{default:s(l=>[n(e,{link:"",type:"primary",onClick:H=>A(l.row.roomId,l.row.id,l.row.location),style:{"background-color":"#409EFF",color:"#fff",border:"none",width:"65px",height:"30px"}},{default:s(()=>[d(" \u8BE6\u60C5 ")]),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data"])):S("",!0),n(O,{total:t(i).pageTotal,"page-size":t(i).pageSize,"page-sizes":t(w),"current-page":t(i).pageNo,onSizeChange:Z,onCurrentChange:j},null,8,["total","page-size","page-sizes","current-page"]),t(v).length==0&&t(y)==0?(h(),W(P,{key:2,description:"\u6682\u65E0\u6570\u636E","image-size":300})):S("",!0)])),[[$,t(q)]])]),_:1},8,["dataList"])}}}),[["__scopeId","data-v-7ccaf5c8"]]);export{Sa as default};
