import{_ as D}from"./Echart.vue_vue_type_script_setup_true_lang-NDPlWfCz.js";import{d as Y,e as h,f as q,aj as O,aU as P,o as w,c as C,j as a,k as o,w as n,a as e,F as K,p as S,n as $,t as r,l as _,S as z,N as H,A as V,J as Z,K as U}from"./index-mcOGIq4g.js";import{E as G}from"./el-card-FPJq94NZ.js";import{_ as J}from"./CardTitle-Bj0gilsX.js";import{_ as B}from"./ContentWrap.vue_vue_type_script_setup_true_lang-BHQCcaX3.js";import{I as A}from"./index-DA5JCs6I.js";import{A as Q}from"./index-Ysd8LNCr.js";import"./dataZoom-Bkxs25kQ.js";import{_ as X}from"./_plugin-vue_export-helper-BCo6x5W8.js";import"./installCanvasRenderer-WHaFMoQ9.js";import"./install-DiAPpr4Z.js";const c=g=>(Z("data-v-4879dd8d"),g=g(),U(),g),aa={class:"energy"},ea={class:"top"},sa={class:"content"},ta={class:"hb-content"},ia={class:"box"},da={class:"value"},la=c(()=>a("div",{class:"introduce"},"\u5F53\u65E5\u7535\u91CF(kW\xB7h)",-1)),oa={class:"box"},na={class:"value"},ra=c(()=>a("div",{class:"introduce"},"\u6628\u65E5\u7535\u91CF(kW\xB7h)",-1)),ca={class:"box"},ma={class:"value"},va=c(()=>a("div",{class:"introduce"},"\u65E5\u73AF\u6BD4",-1)),ya={class:"box"},pa={class:"value"},ua=c(()=>a("div",{class:"introduce"},"\u5F53\u5468\u7535\u91CF(kW\xB7h)",-1)),ha={class:"box"},xa={class:"value"},ba=c(()=>a("div",{class:"introduce"},"\u4E0A\u5468\u7535\u91CF(kW\xB7h)",-1)),ga={class:"box"},ka={class:"value"},Ea=c(()=>a("div",{class:"introduce"},"\u5468\u73AF\u6BD4",-1)),fa={class:"box"},Wa={class:"value"},qa=c(()=>a("div",{class:"introduce"},"\u5F53\u6708\u7535\u91CF(kW\xB7h)",-1)),wa={class:"box"},_a={class:"value"},Aa=c(()=>a("div",{class:"introduce"},"\u4E0A\u6708\u7535\u91CF(kW\xB7h)",-1)),Ma={class:"box"},La={class:"value"},Ta=c(()=>a("div",{class:"introduce"},"\u6708\u73AF\u6BD4",-1)),Fa={class:"chart-nh"},Ia={class:"btns"},Na={class:"bottom"},Ra={class:"value"},ja={class:"time"},Ca=c(()=>a("div",{class:"day"},"\u5F53\u65E5(kW)",-1)),Da={class:"box"},Ya={class:"value"},Oa={class:"time"},Pa=c(()=>a("div",{class:"day"},"\u6628\u65E5(kW)",-1)),Ka=X(Y({__name:"index",setup(g){var N,R;h((N=history==null?void 0:history.state)==null?void 0:N.location);const M=h([]),k=h("DAY"),W={DAY:["\u5F53\u65E5","\u6628\u65E5"],WEEK:["\u5F53\u5468","\u4E0A\u5468"],MONTH:["\u5F53\u6708","\u4E0A\u6708"]},x=h(!1),u=q({roomId:((R=history==null?void 0:history.state)==null?void 0:R.id)||1}),d=q({todayEq:"",yesterdayEq:"",dayRate:"",thisWeekEq:"",lastWeekEq:"",weekRate:"",thisMonthEq:"",lastMonthEq:"",monthRate:""}),y=q({});O(()=>u.roomId,s=>{L(),T(),b("DAY")});const L=async()=>{var t,l,E,f,p;const s=await A.getActivePowTrend(u.roomId);Object.assign(y,s),I.value={grid:{left:"3%",right:"4%",bottom:"3%",containLabel:!0},tooltip:{trigger:"axis",axisPointer:{type:"cross",animation:!1,label:{backgroundColor:"#505765"}}},legend:{data:["\u6628\u65E5","\u5F53\u65E5"],right:"4%"},dataZoom:[{type:"inside",realtime:!0,start:0,end:100}],xAxis:[{type:"category",boundaryGap:!1,axisLine:{onZero:!1},data:((t=s.yesterdayList)==null?void 0:t.length)>0?(l=s.yesterdayList)==null?void 0:l.map(i=>{var v;return(v=i==null?void 0:i.dateTime)==null?void 0:v.split(" ")[1]}):(E=s.todayList)==null?void 0:E.map(i=>{var v;return(v=i==null?void 0:i.dateTime)==null?void 0:v.split(" ")[1]})}],yAxis:[{name:"kW",type:"value"}],series:[{name:"\u6628\u65E5",type:"line",symbol:"none",lineStyle:{width:2},markLine:{data:[{type:"average",name:"Avg1"}]},emphasis:{focus:"series"},data:(f=s.yesterdayList)==null?void 0:f.map(i=>i==null?void 0:i.activePow)},{name:"\u5F53\u65E5",type:"line",symbol:"none",lineStyle:{width:2},emphasis:{focus:"series"},markLine:{data:[{type:"average",name:"Avg2"}]},data:(p=s.todayList)==null?void 0:p.map(i=>i==null?void 0:i.activePow)}]}},T=async()=>{const s=await A.getEleChain(u.roomId);Object.assign(d,s)},b=async s=>{try{x.value=!0;const t=await Q.getEleTrend({id:u.roomId,type:s});F.value={tooltip:{trigger:"axis",axisPointer:{type:"shadow"},formatter:function(l){return`${l[0].seriesName}\uFF1A${l[0].value}kW\xB7h<br>${l[1].seriesName}\uFF1A${l[1].value}kW\xB7h`}},legend:{data:W[s],right:"4%"},grid:{left:"3%",right:"4%",bottom:"3%",containLabel:!0},dataZoom:[{type:"inside",realtime:!0,start:0,end:100}],xAxis:[{type:"category",data:t.map(l=>l.dateTime),axisTick:{alignWithLabel:!0}}],yAxis:[{type:"value",name:"kW\xB7h"}],series:[{name:W[s][0],type:"bar",barWidth:"20%",data:t.map(l=>l.eq.toFixed(1))},{name:W[s][1],type:"bar",barWidth:"20%",data:t.map(l=>l.lastEq.toFixed(1)),itemStyle:{color:"#bd0000"}}]}}finally{x.value=!1,k.value=s}};P(()=>{(async()=>{const s=await A.getRoomList();M.value=s.map(t=>({id:t.id,name:t.roomName}))})(),L(),T(),b("DAY")});const F=h({}),I=h({});return(s,t)=>{const l=z,E=H,f=B,p=J,i=G,v=V,j=D;return w(),C("div",aa,[a("div",ea,[o(f,null,{default:n(()=>[o(E,{modelValue:e(u).roomId,"onUpdate:modelValue":t[0]||(t[0]=m=>e(u).roomId=m),placeholder:"\u8BF7\u9009\u62E9\u673A\u623F",class:"!w-200px"},{default:n(()=>[(w(!0),C(K,null,S(e(M),m=>(w(),$(l,{key:m.id,label:m.name,value:m.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1})]),a("div",sa,[o(i,{class:"card-hb",shadow:"never"},{header:n(()=>[o(p,{title:"\u73AF\u6BD4"})]),default:n(()=>[a("div",ta,[a("div",ia,[a("div",da,r(e(d).todayEq&&e(d).todayEq.toFixed(1)),1),la]),a("div",oa,[a("div",na,r(e(d).yesterdayEq&&e(d).yesterdayEq.toFixed(1)),1),ra]),a("div",ca,[a("div",ma,r(e(d).dayRate),1),va]),a("div",ya,[a("div",pa,r(e(d).thisWeekEq&&e(d).thisWeekEq.toFixed(1)),1),ua]),a("div",ha,[a("div",xa,r(e(d).lastWeekEq&&e(d).lastWeekEq.toFixed(1)),1),ba]),a("div",ga,[a("div",ka,r(e(d).weekRate),1),Ea]),a("div",fa,[a("div",Wa,r(e(d).thisMonthEq&&e(d).thisMonthEq.toFixed(1)),1),qa]),a("div",wa,[a("div",_a,r(e(d).lastMonthEq&&e(d).lastMonthEq.toFixed(1)),1),Aa]),a("div",Ma,[a("div",La,r(e(d).monthRate),1),Ta])])]),_:1}),o(i,{class:"card-nh",shadow:"never"},{header:n(()=>[a("div",Fa,[o(p,{title:"\u80FD\u8017\u8D8B\u52BF"}),a("div",Ia,[o(v,{class:"btn",size:"small",loading:e(x),plain:e(k)!="DAY",type:"primary",onClick:t[1]||(t[1]=m=>b("DAY"))},{default:n(()=>[_("\u5F53\u65E5")]),_:1},8,["loading","plain"]),o(v,{class:"btn",size:"small",loading:e(x),plain:e(k)!="WEEK",type:"primary",onClick:t[2]||(t[2]=m=>b("WEEK"))},{default:n(()=>[_("\u5F53\u5468")]),_:1},8,["loading","plain"]),o(v,{class:"btn",size:"small",loading:e(x),plain:e(k)!="MONTH",type:"primary",onClick:t[3]||(t[3]=m=>b("MONTH"))},{default:n(()=>[_("\u5F53\u6708")]),_:1},8,["loading","plain"])])])]),default:n(()=>[o(j,{options:e(F),height:255},null,8,["options"])]),_:1})]),a("div",Na,[o(i,{class:"card-day",shadow:"never"},{header:n(()=>[o(p,{title:"\u65E5\u7528\u7535\u6709\u529F\u529F\u7387\u66F2\u7EBF"})]),default:n(()=>[o(j,{options:e(I),height:260},null,8,["options"])]),_:1}),o(i,{class:"card-dayTop",shadow:"never"},{header:n(()=>[o(p,{title:"\u6709\u529F\u529F\u7387\u5CF0\u503C"})]),default:n(()=>[a("div",{class:"box",style:{"margin-bottom":"10px"},onClick:t[4]||(t[4]=(...m)=>s.test&&s.test(...m))},[a("div",Ra,r(e(y).todayMax&&e(y).todayMax.toFixed(3)),1),a("div",ja,r(e(y).todayMaxTime),1),Ca]),a("div",Da,[a("div",Ya,r(e(y).yesterdayMax&&e(y).yesterdayMax.toFixed(3)),1),a("div",Oa,r(e(y).yesterdayMaxTime),1),Pa])]),_:1})])])}}}),[["__scopeId","data-v-4879dd8d"]]);export{Ka as default};
