import{d as h,x as C,e as r,o as i,n as f,w as u,k as o,a as l,l as V,s as j,c as N,F as O,p as D,m as E,Z as M,O as Q,S as Z,N as q,Q as z,A as B,R as G}from"./index-mcOGIq4g.js";import{_ as H}from"./Dialog.vue_vue_type_style_index_0_lang-BHwm1lq5.js";import{c as J,d as K}from"./index-DyyrZzBm.js";import{b as L}from"./index-CvtBj4Vl.js";import{u as P}from"./useMessage-CGTQbR_M.js";const T=h({name:"SystemUserAssignRoleForm",__name:"UserAssignRoleForm",emits:["success"],setup(W,{expose:b,emit:k}){const{t:y}=C(),I=P(),m=r(!1),n=r(!1),e=r({id:-1,nickname:"",username:"",roleIds:[]}),t=r(),v=r([]);b({open:async d=>{m.value=!0,F(),e.value.id=d.id,e.value.username=d.username,e.value.nickname=d.nickname,n.value=!0;try{e.value.roleIds=await J(d.id)}finally{n.value=!1}v.value=await L()}});const w=k,U=async()=>{if(t&&await t.value.validate()){n.value=!0;try{await K({userId:e.value.id,roleIds:e.value.roleIds}),I.success(y("common.updateSuccess")),m.value=!1,w("success",!0)}finally{n.value=!1}}},F=()=>{var d;e.value={id:-1,nickname:"",username:"",roleIds:[]},(d=t.value)==null||d.resetFields()};return(d,s)=>{const p=M,c=Q,x=Z,R=q,g=z,_=B,A=H,S=G;return i(),f(A,{modelValue:l(m),"onUpdate:modelValue":s[4]||(s[4]=a=>E(m)?m.value=a:null),title:"\u5206\u914D\u89D2\u8272"},{footer:u(()=>[o(_,{disabled:l(n),type:"primary",onClick:U},{default:u(()=>[V("\u786E \u5B9A")]),_:1},8,["disabled"]),o(_,{onClick:s[3]||(s[3]=a=>m.value=!1)},{default:u(()=>[V("\u53D6 \u6D88")]),_:1})]),default:u(()=>[j((i(),f(g,{ref_key:"formRef",ref:t,model:l(e),"label-width":"80px"},{default:u(()=>[o(c,{label:"\u7528\u6237\u540D\u79F0"},{default:u(()=>[o(p,{modelValue:l(e).username,"onUpdate:modelValue":s[0]||(s[0]=a=>l(e).username=a),disabled:!0},null,8,["modelValue"])]),_:1}),o(c,{label:"\u7528\u6237\u6635\u79F0"},{default:u(()=>[o(p,{modelValue:l(e).nickname,"onUpdate:modelValue":s[1]||(s[1]=a=>l(e).nickname=a),disabled:!0},null,8,["modelValue"])]),_:1}),o(c,{label:"\u89D2\u8272"},{default:u(()=>[o(R,{modelValue:l(e).roleIds,"onUpdate:modelValue":s[2]||(s[2]=a=>l(e).roleIds=a),multiple:"",placeholder:"\u8BF7\u9009\u62E9\u89D2\u8272"},{default:u(()=>[(i(!0),N(O,null,D(l(v),a=>(i(),f(x,{key:a.id,label:a.name,value:a.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1},8,["model"])),[[S,l(n)]])]),_:1},8,["modelValue"])}}});export{T as _};
