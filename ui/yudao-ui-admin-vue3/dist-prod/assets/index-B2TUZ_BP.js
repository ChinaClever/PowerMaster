import{_ as S}from"./Echart.vue_vue_type_script_setup_true_lang-NDPlWfCz.js";import{r as w,d as Z,e as p,f as I,aj as j,aU as B,o as G,c as J,j as a,k as r,w as c,t as l,a as e,l as M,A as U,J as Q,K as V}from"./index-mcOGIq4g.js";import{E as X}from"./el-card-FPJq94NZ.js";import{_ as aa}from"./CardTitle-Bj0gilsX.js";import{_ as ea}from"./ContentWrap.vue_vue_type_script_setup_true_lang-BHQCcaX3.js";import{B as ta}from"./index-D8rWpymm.js";import"./dataZoom-Bkxs25kQ.js";import{_ as sa}from"./_plugin-vue_export-helper-BCo6x5W8.js";import"./installCanvasRenderer-WHaFMoQ9.js";import"./install-DiAPpr4Z.js";const ia=async m=>await w.get({url:"/box/index/activePowTrend",params:m}),da=async m=>await w.get({url:"/box/index/eleChain",params:m}),la=async m=>await w.get({url:"/box/index/eleTrend",params:m}),v=m=>(Q("data-v-246d81a1"),m=m(),V(),m),oa={class:"energy"},na={class:"top"},ra={style:{"margin-right":"10px"}},ca={style:{"margin-right":"10px"}},ya={style:{"margin-right":"10px"}},va={style:{"margin-right":"10px"}},ma={class:"content"},ha={class:"hb-content"},pa={class:"box"},ua={class:"value"},xa=v(()=>a("div",{class:"introduce"},"\u5F53\u65E5\u7535\u91CF(kW\xB7h)",-1)),ba={class:"box"},ga={class:"value"},fa=v(()=>a("div",{class:"introduce"},"\u6628\u65E5\u7535\u91CF(kW\xB7h)",-1)),ka={class:"box"},Ea={class:"value"},Wa=v(()=>a("div",{class:"introduce"},"\u65E5\u73AF\u6BD4",-1)),qa={class:"box"},wa={class:"value"},Ia=v(()=>a("div",{class:"introduce"},"\u5F53\u5468\u7535\u91CF(kW\xB7h)",-1)),Ma={class:"box"},_a={class:"value"},Aa=v(()=>a("div",{class:"introduce"},"\u4E0A\u5468\u7535\u91CF(kW\xB7h)",-1)),La={class:"box"},Ta={class:"value"},Fa=v(()=>a("div",{class:"introduce"},"\u5468\u73AF\u6BD4",-1)),Na={class:"box"},Ka={class:"value"},Ca=v(()=>a("div",{class:"introduce"},"\u5F53\u6708\u7535\u91CF(kW\xB7h)",-1)),Da={class:"box"},Ra={class:"value"},Ya=v(()=>a("div",{class:"introduce"},"\u4E0A\u6708\u7535\u91CF(kW\xB7h)",-1)),ja={class:"box"},Oa={class:"value"},Pa=v(()=>a("div",{class:"introduce"},"\u6708\u73AF\u6BD4",-1)),$a={class:"chart-nh"},za={class:"btns"},Ha={class:"bottom"},Sa={class:"value"},Za={class:"time"},Ba=v(()=>a("div",{class:"day"},"\u5F53\u65E5(kW)",-1)),Ga={class:"box"},Ja={class:"value"},Ua={class:"time"},Qa=v(()=>a("div",{class:"day"},"\u6628\u65E5(kW)",-1)),Va=sa(Z({__name:"index",setup(m){var F,N,K,C,D,R,Y;const O=p((F=history==null?void 0:history.state)==null?void 0:F.roomName),P=p((N=history==null?void 0:history.state)==null?void 0:N.boxName),E=p((K=history==null?void 0:history.state)==null?void 0:K.busName),$=p((C=history==null?void 0:history.state)==null?void 0:C.devKey),z=p([]),W=p([]),k=p("DAY"),q={DAY:["\u5F53\u65E5","\u6628\u65E5"],WEEK:["\u5F53\u5468","\u4E0A\u5468"],MONTH:["\u5F53\u6708","\u4E0A\u6708"]},g=p(!1),u=I({busId:((D=history==null?void 0:history.state)==null?void 0:D.id)||1,cabinetroomId:((R=history==null?void 0:history.state)==null?void 0:R.roomId)||1,devKey:(Y=history==null?void 0:history.state)==null?void 0:Y.devKey}),o=I({todayEq:"",yesterdayEq:"",dayRate:"",thisWeekEq:"",lastWeekEq:"",weekRate:"",thisMonthEq:"",lastMonthEq:"",monthRate:""}),b=I({});j(()=>u.cabinetroomId,t=>{if(W.value=H(t),W.value.length==0)return void(u.busId=null);const s=W.value[0];u.busId=s.id}),j(()=>u.busId,t=>{_(),A(),f("DAY")});const H=t=>{const s=z.value,i=s.findIndex(n=>n.id==t);let y=[];return s[i].children.length>0&&s[i].children[0].type==2?s[i].children.forEach(n=>{n.children.length>0&&n.children.forEach(x=>{y.push(x)})}):s[i].children.length>0&&s[i].children[0].type==3&&(y=s[i].children.map(n=>n)),y},_=async()=>{var s,i,y,n,x;const t=await ia({id:u.busId});Object.assign(b,t),T.value={grid:{left:"3%",right:"4%",bottom:"3%",containLabel:!0},tooltip:{trigger:"axis",axisPointer:{type:"cross",animation:!1,label:{backgroundColor:"#505765"}}},legend:{data:["\u6628\u65E5","\u5F53\u65E5"],right:"4%"},dataZoom:[{type:"inside",realtime:!0,start:0,end:100}],xAxis:[{type:"category",boundaryGap:!1,axisLine:{onZero:!1},data:((s=t.yesterdayList)==null?void 0:s.length)>0?(i=t.yesterdayList)==null?void 0:i.map(d=>{var h;return(h=d==null?void 0:d.dateTime)==null?void 0:h.split(" ")[1]}):(y=t.todayList)==null?void 0:y.map(d=>{var h;return(h=d==null?void 0:d.dateTime)==null?void 0:h.split(" ")[1]})}],yAxis:[{name:"kW",type:"value"}],series:[{name:"\u6628\u65E5",type:"line",symbol:"none",lineStyle:{width:2},markLine:{data:[{type:"average",name:"Avg1"}]},emphasis:{focus:"series"},data:(n=t.yesterdayList)==null?void 0:n.map(d=>d==null?void 0:d.activePow)},{name:"\u5F53\u65E5",type:"line",symbol:"none",lineStyle:{width:2},emphasis:{focus:"series"},markLine:{data:[{type:"average",name:"Avg2"}]},data:(x=t.todayList)==null?void 0:x.map(d=>d==null?void 0:d.activePow)}]}},A=async()=>{const t=await da({id:u.busId});Object.assign(o,t)},f=async t=>{try{g.value=!0;const s=await la({id:u.busId,type:t});L.value={tooltip:{trigger:"axis",axisPointer:{type:"shadow"},formatter:function(i){return`${i[0].seriesName}\uFF1A${i[0].value}kW\xB7h<br>${i[1].seriesName}\uFF1A${i[1].value}kW\xB7h`}},legend:{data:q[t],right:"4%"},grid:{left:"3%",right:"4%",bottom:"3%",containLabel:!0},dataZoom:[{type:"inside",realtime:!0,start:0,end:100}],xAxis:[{type:"category",data:s.map(i=>i.dateTime),axisTick:{alignWithLabel:!0}}],yAxis:[{type:"value",name:"kW\xB7h"}],series:[{name:q[t][0],type:"bar",barWidth:"20%",data:s.map(i=>i.eq.toFixed(1))},{name:q[t][1],type:"bar",barWidth:"20%",data:s.map(i=>i.lastEq.toFixed(1)),itemStyle:{color:"#bd0000"}}]}}finally{g.value=!1,k.value=t}};B(async()=>{await(async()=>{try{const t=await ta.getBoxIdAndLocation(u);t!=null?(u.busId=t.boxId,E.value=t.busName):E.value=null}finally{}})(),_(),A(),f("DAY")});const L=p({}),T=p({});return(t,s)=>{const i=ea,y=aa,n=X,x=U,d=S;return G(),J("div",oa,[a("div",na,[r(i,null,{default:c(()=>[a("span",ra,"\u673A\u623F\uFF1A"+l(e(O)),1),a("span",ca,"\u6BCD\u7EBF\uFF1A"+l(e(E)),1),a("span",ya,"\u63D2\u63A5\u7BB1\uFF1A"+l(e(P)),1),a("span",va,"\u7F51\u7EDC\u5730\u5740\uFF1A"+l(e($)),1)]),_:1})]),a("div",ma,[r(n,{class:"card-hb",shadow:"never"},{header:c(()=>[r(y,{title:"\u73AF\u6BD4"})]),default:c(()=>[a("div",ha,[a("div",pa,[a("div",ua,l(e(o).todayEq&&e(o).todayEq.toFixed(1)),1),xa]),a("div",ba,[a("div",ga,l(e(o).yesterdayEq&&e(o).yesterdayEq.toFixed(1)),1),fa]),a("div",ka,[a("div",Ea,l(e(o).dayRate),1),Wa]),a("div",qa,[a("div",wa,l(e(o).thisWeekEq&&e(o).thisWeekEq.toFixed(1)),1),Ia]),a("div",Ma,[a("div",_a,l(e(o).lastWeekEq&&e(o).lastWeekEq.toFixed(1)),1),Aa]),a("div",La,[a("div",Ta,l(e(o).weekRate),1),Fa]),a("div",Na,[a("div",Ka,l(e(o).thisMonthEq&&e(o).thisMonthEq.toFixed(1)),1),Ca]),a("div",Da,[a("div",Ra,l(e(o).lastMonthEq&&e(o).lastMonthEq.toFixed(1)),1),Ya]),a("div",ja,[a("div",Oa,l(e(o).monthRate),1),Pa])])]),_:1}),r(n,{class:"card-nh",shadow:"never"},{header:c(()=>[a("div",$a,[r(y,{title:"\u80FD\u8017\u8D8B\u52BF"}),a("div",za,[r(x,{class:"btn",size:"small",loading:e(g),plain:e(k)!="DAY",type:"primary",onClick:s[0]||(s[0]=h=>f("DAY"))},{default:c(()=>[M("\u5F53\u65E5")]),_:1},8,["loading","plain"]),r(x,{class:"btn",size:"small",loading:e(g),plain:e(k)!="WEEK",type:"primary",onClick:s[1]||(s[1]=h=>f("WEEK"))},{default:c(()=>[M("\u5F53\u5468")]),_:1},8,["loading","plain"]),r(x,{class:"btn",size:"small",loading:e(g),plain:e(k)!="MONTH",type:"primary",onClick:s[2]||(s[2]=h=>f("MONTH"))},{default:c(()=>[M("\u5F53\u6708")]),_:1},8,["loading","plain"])])])]),default:c(()=>[r(d,{options:e(L),height:255},null,8,["options"])]),_:1})]),a("div",Ha,[r(n,{class:"card-day",shadow:"never"},{header:c(()=>[r(y,{title:"\u65E5\u7528\u7535\u6709\u529F\u529F\u7387\u66F2\u7EBF"})]),default:c(()=>[r(d,{options:e(T),height:260},null,8,["options"])]),_:1}),r(n,{class:"card-dayTop",shadow:"never"},{header:c(()=>[r(y,{title:"\u6709\u529F\u529F\u7387\u5CF0\u503C"})]),default:c(()=>[a("div",{class:"box",style:{"margin-bottom":"10px"},onClick:s[3]||(s[3]=(...h)=>t.test&&t.test(...h))},[a("div",Sa,l(e(b).todayMax&&e(b).todayMax.toFixed(3)),1),a("div",Za,l(e(b).todayMaxTime),1),Ba]),a("div",Ga,[a("div",Ja,l(e(b).yesterdayMax&&e(b).yesterdayMax.toFixed(3)),1),a("div",Ua,l(e(b).yesterdayMaxTime),1),Qa])]),_:1})])])}}}),[["__scopeId","data-v-246d81a1"]]);export{Va as default};
