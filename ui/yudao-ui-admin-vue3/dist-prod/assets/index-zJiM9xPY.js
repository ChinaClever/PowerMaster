import{d as ae,u as le,e as r,f as T,h as te,aU as ie,o as b,n as U,w as s,j as n,t as c,a as o,k as t,l as p,m as se,s as D,c as L,F as ne,p as oe,ax as de,I as B,q as re,A as pe,O as ue,c4 as ce,_ as me,Q as ye,D as ve,G as ge,R as fe,J as he,K as be}from"./index-mcOGIq4g.js";import{_ as xe}from"./CommonMenu-CxUjeIT-.js";import{E as _e}from"./el-empty-Bl_qCsZJ.js";import{_ as ke}from"./index.vue_vue_type_script_setup_true_lang-DcNux-x9.js";import{E as Ee}from"./el-text-BVz5ES0N.js";import{_ as we}from"./dn-BqCJhieo.js";import{I as E}from"./index-D-gmWooi.js";import{_ as Ke}from"./_plugin-vue_export-helper-BCo6x5W8.js";import"./ContentWrap.vue_vue_type_script_setup_true_lang-BHQCcaX3.js";import"./el-card-FPJq94NZ.js";import"./NavTree-CcS5UKLK.js";import"./index-BFNvSS9e.js";const f=x=>(he("data-v-a1c1904d"),x=x(),be(),x),qe={class:"navInfo"},Ne={style:{"font-size":"14px","margin-top":"45px","margin-left":"20px"}},Ce=f(()=>n("div",null,[n("span",null,"\u7528\u80FD\u6700\u5927IP")],-1)),De=f(()=>n("span",null,"\u6628\u65E5\uFF1A",-1)),Le=f(()=>n("span",null,"\u4E0A\u5468\uFF1A",-1)),We=f(()=>n("span",null,"\u4E0A\u6708\uFF1A",-1)),ze=f(()=>n("div",{class:"line"},null,-1)),Se={class:"matrixContainer"},Ie={class:"content"},Me={class:"info"},Fe=f(()=>n("img",{class:"count_img",alt:"",src:we},null,-1)),Ge={class:"room"},Te=["onClick"],Ue=Ke(ae({__name:"index",setup(x){const{push:P}=le(),g=r(void 0),w=r(!1),V=r(!0),W=r([]),h=r([]);r([]);const v=r(0),A=r([]);r(0),r(0),r(0);const z=r("\u65E0\u6570\u636E"),S=r("\u65E0\u6570\u636E"),I=r("\u65E0\u6570\u636E"),K=r([24,36,48,96]),d=T({company:void 0,pageNo:1,pageSize:24,pageTotal:0,busDevKeyList:void 0,isDeleted:0,devKey:void 0,timeGranularity:""});T({company:void 0,pageNo:1,pageSize:-1,pageTotal:0,busDevKeyList:void 0,isDeleted:0});const q=r([]),O=(a,e)=>{e(a?q.value.filter(j(a)):q.value)},j=a=>e=>e.value.toLowerCase().indexOf(a.toLowerCase())===0,m=async(a=!1)=>{w.value=!0,a&&(d.pageNo=1);try{const e=await E.getEqPage({pageNo:d.pageNo,pageSize:d.pageSize,cabinetIds:V.value?null:A.value,runStatus:[],pduBox:0,company:d.company,busDevKeyList:d.busDevKeyList,isDeleted:d.isDeleted,timeGranularity:d.timeGranularity});e.list&&(h.value=e.list.map(l=>({id:l.id,devKey:l.devKey,busName:l.busName,location:l.location||(l.devKey&&l.busName?l.devKey+"-"+l.busName:null),local:l.location,roomName:l.roomName,yesterdayEq:l.yesterdayEq?l.yesterdayEq.toFixed(1):"0.0",lastWeekEq:l.lastWeekEq?l.lastWeekEq.toFixed(1):"0.0",lastMonthEq:l.lastMonthEq?l.lastMonthEq.toFixed(1):"0.0",status:l.runStatus})),d.pageTotal=e.total)}finally{w.value=!1}},M=a=>{v.value!=a&&(v.value=a,d.pageSize=a==0?24:15,m(!0))},J=a=>{if(a.length==0)return d.busDevKeyList=null,void m();const e=[];var l=!1;a.forEach(u=>{u.type==6&&(e.push(u.unique),l=!0)}),d.busDevKeyList=l?e:[-1],m(!0)},F=()=>{g.value!=null&&g.value!=""?d.busDevKeyList=[g.value]:d.busDevKeyList=void 0,m(!0)},Q=()=>{d.busDevKeyList=void 0,m(!0)},N=a=>{d.timeGranularity=a,m(!0)},G=a=>{P({path:"/bus/busmonitor/busenergydetail",state:{devKey:a.devKey,roomId:a.roomId,id:a.id,location:a.location,busName:a.busName,roomName:a.roomName,local:a.local}})};return te(async()=>{q.value=await(async()=>(await E.devKeyList()).map(a=>({value:a})))()}),ie(()=>{(async()=>{const a=await E.getBusMenu();if(W.value=a,a&&a.length>0){const e=a[0],l=[];e.children.forEach(u=>{u.children.length>0&&u.children.forEach(_=>{l.push(_.id+"-"+_.type)})})}})(),m(),(async()=>{try{const a=await E.getEqMax();a&&a.forEach(e=>{e.id==0?z.value=e.devKey:e.id==1?S.value=e.devKey:e.id==2&&(I.value=e.devKey)})}finally{}})()}),(a,e)=>{const l=pe,u=ue,_=ce,k=me,R=ye,y=ve,C=Ee,$=ge,H=ke,X=_e,Y=xe,Z=fe;return b(),U(Y,{dataList:o(W),onCheck:J,navTitle:"\u6BCD\u7EBF\u7528\u80FD"},{NavInfo:s(()=>[n("div",qe,[n("div",Ne,[Ce,n("div",null,[De,n("span",null,c(o(z)),1)]),n("div",null,[Le,n("span",null,c(o(S)),1)]),n("div",null,[We,n("span",null,c(o(I)),1)])]),ze])]),ActionBar:s(()=>[t(R,{class:"-mb-15px",model:o(d),inline:!0,"label-width":"68px"},{default:s(()=>[t(u,{label:"\u7528\u80FD\u6392\u5E8F","label-width":"100px",style:{"margin-left":"-30px"}},{default:s(()=>[t(l,{onClick:e[0]||(e[0]=i=>N("yesterday"))},{default:s(()=>[p(" \u6628\u65E5 ")]),_:1}),t(l,{onClick:e[1]||(e[1]=i=>N("lastWeek"))},{default:s(()=>[p(" \u4E0A\u5468 ")]),_:1}),t(l,{onClick:e[2]||(e[2]=i=>N("lastMonth"))},{default:s(()=>[p(" \u4E0A\u6708 ")]),_:1})]),_:1}),t(u,{label:"\u7F51\u7EDC\u5730\u5740",prop:"devKey",style:{"margin-left":"80px"}},{default:s(()=>[t(_,{modelValue:o(g),"onUpdate:modelValue":e[3]||(e[3]=i=>se(g)?g.value=i:null),"fetch-suggestions":O,clearable:"",class:"!w-160px",placeholder:"\u8BF7\u8F93\u5165\u7F51\u7EDC\u5730\u5740",onSelect:F},null,8,["modelValue"]),t(u,{style:{"margin-left":"5px","margin-right":"6px"}},{default:s(()=>[t(l,{onClick:F,style:{width:"70px"}},{default:s(()=>[t(k,{icon:"ep:search",class:"mr-5px"}),p(" \u641C\u7D22")]),_:1}),t(l,{onClick:Q,style:{width:"70px"}},{default:s(()=>[t(k,{icon:"ep:refresh",class:"mr-5px"}),p(" \u91CD\u7F6E")]),_:1})]),_:1})]),_:1}),t(u,{style:{"margin-left":"auto"}},{default:s(()=>[t(l,{onClick:e[4]||(e[4]=i=>{K.value=[24,36,48,96],M(0)}),type:o(v)?"":"primary"},{default:s(()=>[t(k,{icon:"ep:grid",style:{"margin-right":"8px"}}),p("\u9635\u5217\u6A21\u5F0F")]),_:1},8,["type"]),t(l,{onClick:e[5]||(e[5]=i=>{K.value=[15,25,30,50,100],o(d).pageSize=15,M(1)}),type:o(v)?"primary":""},{default:s(()=>[t(k,{icon:"ep:expand",style:{"margin-right":"8px"}}),p("\u8868\u683C\u6A21\u5F0F")]),_:1},8,["type"])]),_:1})]),_:1},8,["model"])]),Content:s(()=>[D((b(),L("div",null,[D(n("div",Se,[(b(!0),L(ne,null,oe(o(h),i=>(b(),L("div",{class:"item",key:i.key},[n("div",Ie,[n("div",Me,[n("div",null,"\u6628\u65E5\u7528\u80FD\uFF1A"+c(i.yesterdayEq)+"kW\xB7h",1),n("div",null,"\u4E0A\u5468\u7528\u80FD\uFF1A"+c(i.lastWeekEq)+"kW\xB7h",1),n("div",null,"\u4E0A\u6708\u7528\u80FD\uFF1A"+c(i.lastMonthEq)+"kW\xB7h",1)]),Fe]),n("div",Ge,c(i.location),1),n("button",{class:"detail",onClick:de(ee=>G(i),["prevent"])},"\u8BE6\u60C5",8,Te)]))),128))],512),[[B,o(v)==0&&o(h).length>0]]),D(t($,{style:{width:"100%",height:"720px","margin-top":"-10px","overflow-y":"auto"},data:o(h),border:!0},{default:s(()=>[t(y,{type:"index",width:"80px",label:"\u5E8F\u53F7",align:"center"}),t(y,{label:"\u4F4D\u7F6E","min-width":"110",align:"center",prop:"local"}),t(y,{label:"\u8BBE\u5907\u540D\u79F0",align:"center",prop:"busName"}),t(y,{label:"\u7F51\u7EDC\u5730\u5740",align:"center",prop:"devKey","class-name":a.ip},null,8,["class-name"]),t(y,{label:"\u6628\u65E5\u7528\u80FD(kW\xB7h)","min-width":"110",align:"center",prop:"yesterdayEq"},{default:s(i=>[t(C,{"line-clamp":"2"},{default:s(()=>[p(c(i.row.yesterdayEq),1)]),_:2},1024)]),_:1}),t(y,{label:"\u4E0A\u5468\u7528\u80FD(kW\xB7h)","min-width":"110",align:"center",prop:"lastWeekEq"},{default:s(i=>[t(C,{"line-clamp":"2"},{default:s(()=>[p(c(i.row.lastWeekEq),1)]),_:2},1024)]),_:1}),t(y,{label:"\u4E0A\u6708\u7528\u80FD(kW\xB7h)","min-width":"110",align:"center",prop:"lastMonthEq"},{default:s(i=>[t(C,{"line-clamp":"2"},{default:s(()=>[p(c(i.row.lastMonthEq),1)]),_:2},1024)]),_:1}),t(y,{label:"\u64CD\u4F5C",align:"center"},{default:s(i=>[t(l,{link:"",type:"primary",onClick:ee=>G(i.row),style:{"background-color":"#409EFF",color:"#fff",border:"none",width:"100px",height:"30px"}},{default:s(()=>[p(" \u8BE6\u60C5 ")]),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data"]),[[B,o(v)==1]]),t(H,{total:o(d).pageTotal,"page-size-arr":o(K),page:o(d).pageNo,"onUpdate:page":e[6]||(e[6]=i=>o(d).pageNo=i),limit:o(d).pageSize,"onUpdate:limit":e[7]||(e[7]=i=>o(d).pageSize=i),onPagination:e[8]||(e[8]=i=>m(!1))},null,8,["total","page-size-arr","page","limit"]),o(h).length==0&&o(v)==0?(b(),U(X,{key:0,description:"\u6682\u65E0\u6570\u636E","image-size":595})):re("",!0)])),[[Z,o(w)]])]),_:1},8,["dataList"])}}}),[["__scopeId","data-v-a1c1904d"]]);export{Ue as default};
