import{cr as re,b1 as de,aB as fe,aG as G,bl as ve,aF as P,d as V,cs as H,ct as me,cu as pe,bj as be,aC as ge,cv as ke,e as _,cw as xe,cl as we,g as w,aj as J,ao as ye,h as Ie,o as N,n as K,k as i,w as p,j as m,a0 as f,a,v as U,ax as Ce,q as O,a$ as k,cx as _e,c as X,F as Z,bs as ze,bt as he,cy as Ne,cz as Oe,as as Te,cA as Ae,cB as Ee,p as Le,s as Re,I as Se,aD as Xe,a3 as Ye,cC as Be,b0 as Fe,cD as E,bK as z,cE as $e,aN as De}from"./index-mcOGIq4g.js";function Y(b,T,v){var y=!0,n=!0;if(typeof b!="function")throw new TypeError("Expected a function");return re(v)&&(y="leading"in v?!!v.leading:y,n="trailing"in v?!!v.trailing:n),de(b,T,{leading:y,maxWait:T,trailing:n})}const je=fe({urlList:{type:G(Array),default:()=>ve([])},zIndex:{type:Number},initialIndex:{type:Number,default:0},infinite:{type:Boolean,default:!0},hideOnClickModal:Boolean,teleported:Boolean,closeOnPressEscape:{type:Boolean,default:!0},zoomRate:{type:Number,default:1.2},minScale:{type:Number,default:.2},maxScale:{type:Number,default:7},crossorigin:{type:G(String)}}),Me={close:()=>!0,switch:b=>P(b),rotate:b=>P(b)},We=["src","crossorigin"],qe=V({name:"ElImageViewer"}),Ge=De(Fe(V({...qe,props:je,emits:Me,setup(b,{expose:T,emit:v}){var y;const n=b,h={CONTAIN:{name:"contain",icon:H(me)},ORIGINAL:{name:"original",icon:H(pe)}},{t:Q}=be(),l=ge("image-viewer"),{nextZIndex:ee}=ke(),L=_(),B=_([]),F=xe(),I=_(!0),g=_(n.initialIndex),A=we(h.CONTAIN),t=_({scale:1,deg:0,offsetX:0,offsetY:0,enableTransition:!1}),ae=_((y=n.zIndex)!=null?y:ee()),se=w(()=>{const{urlList:e}=n;return e.length<=1}),$=w(()=>g.value===0),D=w(()=>g.value===n.urlList.length-1),ne=w(()=>n.urlList[g.value]),le=w(()=>[l.e("btn"),l.e("prev"),l.is("disabled",!n.infinite&&$.value)]),te=w(()=>[l.e("btn"),l.e("next"),l.is("disabled",!n.infinite&&D.value)]),oe=w(()=>{const{scale:e,deg:s,offsetX:o,offsetY:u,enableTransition:c}=t.value;let r=o/e,d=u/e;switch(s%360){case 90:case-270:[r,d]=[d,-r];break;case 180:case-180:[r,d]=[-r,-d];break;case 270:case-90:[r,d]=[-d,r]}const C={transform:`scale(${e}) rotate(${s}deg) translate(${r}px, ${d}px)`,transition:c?"transform .3s":""};return A.value.name===h.CONTAIN.name&&(C.maxWidth=C.maxHeight="100%"),C});function R(){F.stop(),v("close")}function ie(){I.value=!1}function ce(e){I.value=!1,e.target.alt=Q("el.image.error")}function ue(e){if(I.value||e.button!==0||!L.value)return;t.value.enableTransition=!1;const{offsetX:s,offsetY:o}=t.value,u=e.pageX,c=e.pageY,r=Y(C=>{t.value={...t.value,offsetX:s+C.pageX-u,offsetY:o+C.pageY-c}}),d=E(document,"mousemove",r);E(document,"mouseup",()=>{d()}),e.preventDefault()}function j(){t.value={scale:1,deg:0,offsetX:0,offsetY:0,enableTransition:!1}}function M(){if(I.value)return;const e=$e(h),s=Object.values(h),o=A.value.name,u=(s.findIndex(c=>c.name===o)+1)%e.length;A.value=h[e[u]],j()}function S(e){const s=n.urlList.length;g.value=(e+s)%s}function W(){$.value&&!n.infinite||S(g.value-1)}function q(){D.value&&!n.infinite||S(g.value+1)}function x(e,s={}){if(I.value)return;const{minScale:o,maxScale:u}=n,{zoomRate:c,rotateDeg:r,enableTransition:d}={zoomRate:n.zoomRate,rotateDeg:90,enableTransition:!0,...s};switch(e){case"zoomOut":t.value.scale>o&&(t.value.scale=Number.parseFloat((t.value.scale/c).toFixed(3)));break;case"zoomIn":t.value.scale<u&&(t.value.scale=Number.parseFloat((t.value.scale*c).toFixed(3)));break;case"clockwise":t.value.deg+=r,v("rotate",t.value.deg);break;case"anticlockwise":t.value.deg-=r,v("rotate",t.value.deg)}t.value.enableTransition=d}return J(ne,()=>{ye(()=>{const e=B.value[0];e!=null&&e.complete||(I.value=!0)})}),J(g,e=>{j(),v("switch",e)}),Ie(()=>{var e,s;(function(){const o=Y(c=>{switch(c.code){case z.esc:n.closeOnPressEscape&&R();break;case z.space:M();break;case z.left:W();break;case z.up:x("zoomIn");break;case z.right:q();break;case z.down:x("zoomOut")}}),u=Y(c=>{x((c.deltaY||c.deltaX)<0?"zoomIn":"zoomOut",{zoomRate:n.zoomRate,enableTransition:!1})});F.run(()=>{E(document,"keydown",o),E(document,"wheel",u)})})(),(s=(e=L.value)==null?void 0:e.focus)==null||s.call(e)}),T({setActiveItem:S}),(e,s)=>(N(),K(Be,{to:"body",disabled:!e.teleported},[i(Ye,{name:"viewer-fade",appear:""},{default:p(()=>[m("div",{ref_key:"wrapper",ref:L,tabindex:-1,class:f(a(l).e("wrapper")),style:U({zIndex:ae.value})},[m("div",{class:f(a(l).e("mask")),onClick:s[0]||(s[0]=Ce(o=>e.hideOnClickModal&&R(),["self"]))},null,2),O(" CLOSE "),m("span",{class:f([a(l).e("btn"),a(l).e("close")]),onClick:R},[i(a(k),null,{default:p(()=>[i(a(_e))]),_:1})],2),O(" ARROW "),a(se)?O("v-if",!0):(N(),X(Z,{key:0},[m("span",{class:f(a(le)),onClick:W},[i(a(k),null,{default:p(()=>[i(a(ze))]),_:1})],2),m("span",{class:f(a(te)),onClick:q},[i(a(k),null,{default:p(()=>[i(a(he))]),_:1})],2)],64)),O(" ACTIONS "),m("div",{class:f([a(l).e("btn"),a(l).e("actions")])},[m("div",{class:f(a(l).e("actions__inner"))},[i(a(k),{onClick:s[1]||(s[1]=o=>x("zoomOut"))},{default:p(()=>[i(a(Ne))]),_:1}),i(a(k),{onClick:s[2]||(s[2]=o=>x("zoomIn"))},{default:p(()=>[i(a(Oe))]),_:1}),m("i",{class:f(a(l).e("actions__divider"))},null,2),i(a(k),{onClick:M},{default:p(()=>[(N(),K(Te(a(A).icon)))]),_:1}),m("i",{class:f(a(l).e("actions__divider"))},null,2),i(a(k),{onClick:s[3]||(s[3]=o=>x("anticlockwise"))},{default:p(()=>[i(a(Ae))]),_:1}),i(a(k),{onClick:s[4]||(s[4]=o=>x("clockwise"))},{default:p(()=>[i(a(Ee))]),_:1})],2)],2),O(" CANVAS "),m("div",{class:f(a(l).e("canvas"))},[(N(!0),X(Z,null,Le(e.urlList,(o,u)=>Re((N(),X("img",{ref_for:!0,ref:c=>B.value[u]=c,key:o,src:o,style:U(a(oe)),class:f(a(l).e("img")),crossorigin:e.crossorigin,onLoad:ie,onError:ce,onMousedown:ue},null,46,We)),[[Se,u===g.value]])),128))],2),Xe(e.$slots,"default")],6)]),_:3})],8,["disabled"]))}}),[["__file","image-viewer.vue"]]));export{Ge as E};
