import{_ as R}from"./ContentWrap.vue_vue_type_script_setup_true_lang-BHQCcaX3.js";import{d as P,u as q,e as x,f as z,aj as V,h as H,o as s,n as J,w as C,j as a,v as I,a as c,c as o,q as m,F as A,p as k,t as v,k as K,l as M,ax as G,ao as w,A as Q,J as U,K as X}from"./index-mcOGIq4g.js";import{n as Y}from"./jsplumb.browser-ui.es-D8lVyB7K.js";import{M as N}from"./index-CN_W-U9Z.js";import{u as Z}from"./useMessage-CGTQbR_M.js";import{_ as f}from"./_plugin-vue_export-helper-BCo6x5W8.js";import"./el-card-FPJq94NZ.js";const y=g=>(U("data-v-fcadc012"),g=g(),X(),g),ee={key:0,class:"Bus"},ae={key:0,class:"startBus"},te={class:"main"},ie={key:0,class:"busListContainer"},le=y(()=>a("div",{class:"bridge"},null,-1)),ne={class:"busList1"},se={key:0,class:"plugin-box"},de=y(()=>a("div",{class:"box"},[a("div",null,"Ia"),a("div",null,"30")],-1)),oe=y(()=>a("div",{class:"box"},[a("div",null,"Ib"),a("div",null,"8.1")],-1)),ce=y(()=>a("div",{class:"box"},[a("div",null,"Ic"),a("div",null,"50")],-1)),re=y(()=>a("div",{class:"name"},"\u7535\u6D41",-1)),ue=["id"],ve=["id"],be=["id"],me={key:1,class:"template-box"},pe=[y(()=>a("div",{class:"connector"},[a("span",{class:"text"},"\u8FDE\u63A5\u5668")],-1)),y(()=>a("div",{class:"Tbox"},[a("div",{class:"T"},[a("div",null,"T(L1)"),a("div",null,"30\xB0C")]),a("div",{class:"T"},[a("div",null,"T(L2)"),a("div",null,"30\xB0C")]),a("div",{class:"T"},[a("div",null,"T(L3)"),a("div",null,"30\xB0C")]),a("div",{class:"T"},[a("div",null,"T(N)"),a("div",null,"30\xB0C")])],-1))],ye={key:1,class:"busListContainer"},Be=y(()=>a("div",{class:"bridge"},null,-1)),xe={class:"busList2"},Ae={key:0,class:"plugin-box"},ge=y(()=>a("div",{class:"box"},[a("div",null,"Ia"),a("div",null,"30")],-1)),Ee=y(()=>a("div",{class:"box"},[a("div",null,"Ib"),a("div",null,"8.1")],-1)),ke=y(()=>a("div",{class:"box"},[a("div",null,"Ic"),a("div",null,"50")],-1)),Ie=y(()=>a("div",{class:"name"},"\u7535\u6D41",-1)),Ne=["id"],_e=["id"],he=["id"],Le={key:1,class:"template-box"},Ce=[y(()=>a("div",{class:"connector"},[a("span",{class:"text"},"\u8FDE\u63A5\u5668")],-1)),y(()=>a("div",{class:"Tbox"},[a("div",{class:"T"},[a("div",null,"T(L1)"),a("div",null,"30\xB0C")]),a("div",{class:"T"},[a("div",null,"T(L2)"),a("div",null,"30\xB0C")]),a("div",{class:"T"},[a("div",null,"T(L3)"),a("div",null,"30\xB0C")]),a("div",{class:"T"},[a("div",null,"T(N)"),a("div",null,"30\xB0C")])],-1))],we={class:"cabinetContainer"},Te={key:0,class:"cabinetList"},De={class:"point"},Oe=["id"],$e=["id"],Se={class:"cabinet"},We=["id"],je={key:0},Fe={key:1},Re={key:2},Pe={key:3},qe={key:4},ze={key:5},Ve={key:6},He={key:7},Je={key:8},Ke={key:9},Me={key:10},Ge=["id"],Qe={class:"status"},Ue={key:1,class:"Bus"},Xe={key:0,class:"startBus"},Ye={class:"btns"},Ze=f(P({__name:"Topology",props:{cabinetColumnId:{type:String}},setup(g){Z();const{push:T}=q();let e=null;const{cabinetColumnId:D}=g,O=[{value:0,name:"\u8D1F\u8377"},{value:1,name:"\u7535\u6D41"},{value:2,name:"\u7535\u538B"},{value:3,name:"\u529F\u7387\u56E0\u7D20"},{value:4,name:"\u6709\u529F\u529F\u7387"},{value:5,name:"\u65E0\u529F\u529F\u7387"},{value:6,name:"\u89C6\u5728\u529F\u7387"},{value:7,name:"\u4F9B\u7535\u5E73\u8861"},{value:8,name:"\u6E29\u5EA6"},{value:9,name:"\u5BB9\u91CF"},{value:10,name:"\u7528\u80FD"}],_=x(),B=x(0);x(!1);const u=z({}),p=x([]);x([]),x([]);const h=x({left:"0px",top:"0px",show:!1,add:!1,curIndex:0}),$=(n,i={})=>{const r=document.getElementById("cab-A-"+n),l=document.getElementById("cab-B-"+n);if(e==null||e.removeAllEndpoints(r),e==null||e.removeAllEndpoints(l),i.boxNameA&&i.boxOutletIdA||(e==null||e.addEndpoint(r,{source:!0,target:!0,endpoint:"Dot"})),i.boxNameB&&i.boxOutletIdB||(e==null||e.addEndpoint(l,{source:!0,target:!0,endpoint:"Dot"})),i.boxNameA&&i.boxOutletIdA){const t=document.getElementById("cab-A-"+n),d=document.getElementById(`${i.boxNameA}_A-${i.boxOutletIdA}`);e==null||e.connect({source:t,target:d,paintStyle:{strokeWidth:1,stroke:"#ccc",dashstyle:"5 5"}})}if(i.boxNameB&&i.boxOutletIdB){const t=document.getElementById("cab-B-"+n),d=document.getElementById(`${i.boxNameB}_B-${i.boxOutletIdB}`);e==null||e.connect({source:t,target:d,paintStyle:{strokeWidth:1,stroke:"#bb0000",dashstyle:"5 5"}})}e==null||e.revalidate(r),e==null||e.revalidate(l)},S=()=>{p.value.forEach((n,i)=>{n.cabinetName&&u.barA&&w(()=>{const r=document.getElementById("cab-A-"+i),l=document.getElementById("cab-B-"+i);e==null||e.revalidate(r),e==null||e.revalidate(l),p.value&&p.value.length&&u.barA&&(u.barA.boxList.forEach(t=>{if(t.type)return;const d=document.getElementById(t.boxName+"_A-1"),b=document.getElementById(t.boxName+"_A-2"),E=document.getElementById(t.boxName+"_A-3");e==null||e.revalidate(d),e==null||e.revalidate(b),e==null||e.revalidate(E)}),u.barB.boxList.forEach(t=>{const d=document.getElementById(t.boxName+"_B-1"),b=document.getElementById(t.boxName+"_B-2"),E=document.getElementById(t.boxName+"_B-3");e==null||e.revalidate(d),e==null||e.revalidate(b),e==null||e.revalidate(E)}))})})},W=(n,i)=>{const r=[];for(let l=0;l<n.length;l++)r.push({});n.cabinetList&&n.cabinetList.forEach(l=>{r.splice(l.index-1,1,l)}),p.value=r,L(i),p.value&&p.value.length&&u.barA&&w(()=>{u.barA.boxList.forEach(l=>{if(l.type)return;const t=document.getElementById(l.boxName+"_A-1"),d=document.getElementById(l.boxName+"_A-2"),b=document.getElementById(l.boxName+"_A-3");e==null||e.removeAllEndpoints(t),e==null||e.removeAllEndpoints(d),e==null||e.removeAllEndpoints(b),e==null||e.addEndpoint(t,{source:!0,target:!0,endpoint:"Dot"}),e==null||e.addEndpoint(d,{source:!0,target:!0,endpoint:"Dot"}),e==null||e.addEndpoint(b,{source:!0,target:!0,endpoint:"Dot"}),e==null||e.revalidate(t),e==null||e.revalidate(d),e==null||e.revalidate(b)}),u.barB.boxList.forEach(l=>{if(l.type)return;const t=document.getElementById(l.boxName+"_B-1"),d=document.getElementById(l.boxName+"_B-2"),b=document.getElementById(l.boxName+"_B-3");e==null||e.removeAllEndpoints(t),e==null||e.removeAllEndpoints(d),e==null||e.removeAllEndpoints(b),e==null||e.deleteEndpoint(l.boxName+"_B-1"),e==null||e.deleteEndpoint(l.boxName+"_B-2"),e==null||e.deleteEndpoint(l.boxName+"_B-3"),e==null||e.addEndpoint(t,{source:!0,target:!0,endpoint:"Dot"}),e==null||e.addEndpoint(d,{source:!0,target:!0,endpoint:"Dot"}),e==null||e.addEndpoint(b,{source:!0,target:!0,endpoint:"Dot"}),e==null||e.revalidate(t),e==null||e.revalidate(d),e==null||e.revalidate(b)}),p.value.forEach((l,t)=>{l.cabinetName&&$(t,l)})})},L=n=>{n.barA&&n.barA.boxList.forEach((i,r)=>{u.barA.boxList[r]={...u.barA.boxList[r],...i}}),n.barB&&n.barB.boxList.forEach((i,r)=>{u.barB.boxList[r]={...u.barB.boxList[r],...i}}),n.cabinetList&&n.cabinetList.forEach(i=>{p.value.forEach((r,l)=>{r.id!=i.id||(p.value[l]={...r,...i})})})},j=()=>{T({path:"/aisle/topology",state:{id:6}})};return(async()=>{const n=N.getAisleDetail({id:6}),i=N.getDataDetail({id:6});Promise.all([n,i]).then(r=>{Object.assign(u,r[0]),W(r[0],r[1])})})(),window.addEventListener("resize",function(){S()}),V(()=>D,n=>{}),H(()=>{e=Y({container:_.value}),e.bind("beforeDrop",({connection:n})=>{const i=n.source.id,r=n.target.id,l=i.includes("cab")?i:r,t=l.split("-")[2],d=l.split("-")[1],b=i.includes("plugin")?i:r,E=b.split("_")[0],F=b.split("-")[2];return!(l.split("-")[0]==b.split("-")[0]||d=="A"&&b.includes("B")||d=="B"&&b.includes("A")||(p.value[t][`boxOutletId${d}`]=+F,p.value[t][`boxName${d}`]=1+Number(E.split("-")[1]),d=="A"?n.paintStyle={strokeWidth:1,stroke:"#ccc",dashstyle:"5 5"}:d=="B"&&(n.paintStyle={strokeWidth:1,stroke:"#bb0000",dashstyle:"5 5"}),0))}),e.bind("beforeDetach",function(n){if(n.suspendedElement){const i=n.target.id.includes("cab")?n.target.id:n.source.id,r=i.split("-")[1],l=i.split("-")[2];p.value[l][`boxOutletId${r}`]="",p.value[l][`boxName${r}`]=""}return!0}),setInterval(()=>{(async()=>{const n=await N.getDataDetail({id:6});L(n)})()},1e4),document.addEventListener("mouseup",n=>{const i=n.target;n.button==0&&h.value.show&&i.className!="menu_item"&&(h.value.show=!1)})}),(n,i)=>{const r=Q,l=R;return s(),J(l,{class:"topologyContentWrap"},{default:C(()=>[a("div",{ref_key:"topologyContainer",ref:_,class:"topologyContainer",style:{position:"relative","z-index":"1"}},[a("div",{class:"Container",style:I({alignItems:c(u).pduBar&&c(u).barA?"unset":"center"})},[c(u).pduBar&&c(u).barA?(s(),o("div",ee,[a("div",{class:"startBus",style:I({opacity:c(u).barA.direction?0:1})}," \u59CB\u7AEF\u7BB1 ",4),c(u).barB.direction?m("",!0):(s(),o("div",ae," \u59CB\u7AEF\u7BB1 "))])):m("",!0),a("div",te,[a("div",null,[c(u).pduBar&&c(u).barA?(s(),o("div",ie,[le,a("div",ne,[(s(!0),o(A,null,k(c(u).barA.boxList,(t,d)=>(s(),o(A,{key:d},[t.type==0?(s(),o("div",se,[de,oe,ce,re,a("div",{id:t.boxName+"_A-1",class:"pointA"},null,8,ue),a("div",{id:t.boxName+"_A-2",class:"pointB"},null,8,ve),a("div",{id:t.boxName+"_A-3",class:"pointC"},null,8,be)])):(s(),o("div",me,pe))],64))),128))])])):m("",!0),c(u).pduBar&&c(u).barB?(s(),o("div",ye,[Be,a("div",xe,[(s(!0),o(A,null,k(c(u).barA.boxList,(t,d)=>(s(),o(A,{key:d},[t.type==0?(s(),o("div",Ae,[ge,Ee,ke,Ie,a("div",{id:t.boxName+"_B-1",class:"pointA"},null,8,Ne),a("div",{id:t.boxName+"_B-2",class:"pointB"},null,8,_e),a("div",{id:t.boxName+"_B-3",class:"pointC"},null,8,he)])):(s(),o("div",Le,Ce))],64))),128))])])):m("",!0)]),a("div",we,[c(p)&&c(p).length?(s(),o("div",Te,[(s(!0),o(A,null,k(c(p),(t,d)=>(s(),o("div",{key:d,class:"cabinetBox"},[a("div",De,[t.cabinetName?(s(),o("div",{key:0,id:"cab-A-"+d,class:"leftPoint"},null,8,Oe)):m("",!0),t.cabinetName?(s(),o("div",{key:1,id:"cab-B-"+d,class:"rightPoint"},null,8,$e)):m("",!0)]),a("div",Se,[t.cabinetName?(s(),o("div",{key:0,class:"inner_fill",id:"cabinet-"+d},[c(B)==0?(s(),o("div",je,"\u8D1F\u8F7D\u7387\uFF1A"+v(t.loadRate),1)):m("",!0),c(B)==1?(s(),o("div",Fe,"A\u8DEF\u7535\u6D41\uFF1A"+v(t.lineCurA||0)+" B\u8DEF\u7535\u6D41\uFF1A"+v(t.lineCurB||0),1)):m("",!0),c(B)==2?(s(),o("div",Re,"A\u8DEF\u7535\u538B\uFF1A"+v(t.lineVolA||0)+" B\u8DEF\u7535\u538B\uFF1A"+v(t.lineVolB||0),1)):m("",!0),c(B)==3?(s(),o("div",Pe,"\u529F\u7387\u56E0\u7D20(\u603B)\uFF1A"+v(t.powerFactor)+" \u529F\u7387\u56E0\u7D20(A)\uFF1A"+v(t.powerFactorA)+"\u529F\u7387\u56E0\u7D20(B)\uFF1A"+v(t.powerFactorB),1)):m("",!0),c(B)==4?(s(),o("div",qe,"\u6709\u529F\u529F\u7387\uFF1A"+v(t.powActive)+" \u6709\u529F\u529F\u7387A\uFF1A"+v(t.powActiveA)+" \u6709\u529F\u529F\u7387B\uFF1A"+v(t.powActiveB),1)):m("",!0),c(B)==5?(s(),o("div",ze,"\u65E0\u529F\u529F\u7387\uFF1A"+v(t.powReactive)+" \u65E0\u529F\u529F\u7387A\uFF1A"+v(t.powReactiveA)+" \u65E0\u529F\u529F\u7387B\uFF1A"+v(t.powReactiveB),1)):m("",!0),c(B)==6?(s(),o("div",Ve,"\u89C6\u5728\u529F\u7387\uFF1A"+v(t.powApparent)+" \u89C6\u5728\u529F\u7387A\uFF1A"+v(t.powApparentA)+" \u89C6\u5728\u529F\u7387B\uFF1A"+v(t.powApparentB),1)):m("",!0),c(B)==7?(s(),o("div",He,"\u4F9B\u7535\u5E73\u8861\uFF1A")):m("",!0),c(B)==8?(s(),o("div",Je,"\u6E29\u5EA6\uFF1A"+v(t.temData),1)):m("",!0),c(B)==9?(s(),o("div",Ke,"\u5BB9\u91CF\uFF1A"+v(t.cabinetHeight)+" \u7A7A\u95F2\u5BB9\u91CF\uFF1A"+v(t.freeSpace),1)):m("",!0),c(B)==10?(s(),o("div",Me,"\u7528\u80FD\uFF1A"+v(t.yesterdayEq),1)):m("",!0)],8,We)):(s(),o("div",{key:1,class:"inner_empty",id:"cabinet-"+d},null,8,Ge))]),a("div",Qe,v(t.cabinetName||""),1)]))),128))])):m("",!0)])]),c(u).pduBar&&c(u).barA?(s(),o("div",Ue,[a("div",{class:"startBus",style:I({opacity:c(u).barA.direction})}," \u59CB\u7AEF\u7BB1 ",4),c(u).barB.direction?(s(),o("div",Xe," \u59CB\u7AEF\u7BB1 ")):m("",!0)])):m("",!0)],4),a("div",Ye,[(s(),o(A,null,k(O,t=>K(r,{key:t.value,onClick:d=>{return b=t.value,void(B.value=b);var b},type:"primary",plain:c(B)!=t.value},{default:C(()=>[M(v(t.name),1)]),_:2},1032,["onClick","plain"])),64))]),a("div",{class:"mask",onClick:i[0]||(i[0]=G(()=>{},["prevent"])),onDblclick:j},null,32)],512)]),_:1})}}}),[["__scopeId","data-v-fcadc012"]]);export{Ze as default};
