import{d as k,e as d,f as L,aU as E,o as G,c as N,k as l,w as r,l as z,t as p,a as s,j as o,v as y,ax as F,F as R,bX as T,aR as q}from"./index-mcOGIq4g.js";import{E as K}from"./el-card-FPJq94NZ.js";import{_ as U}from"./Echart.vue_vue_type_script_setup_true_lang-NDPlWfCz.js";import{_ as W}from"./CardTitle-Bj0gilsX.js";import{I as S}from"./index-B_LT3qVv.js";import{B as j}from"./index-D8rWpymm.js";import{_ as D}from"./_plugin-vue_export-helper-BCo6x5W8.js";import"./installCanvasRenderer-WHaFMoQ9.js";const X={class:"ImbalanceA"},M={class:"IechartBar"},O={class:"IechartBar"},H={class:"value"},J={class:"ImbalanceA"},P={class:"IechartBar"},Q={class:"IechartBar"},Y={class:"value"},Z=k({__name:"index",setup(ae){var C,B,I,w;const h=d(((C=history==null?void 0:history.state)==null?void 0:C.boxId)||-1),x=d(((B=history==null?void 0:history.state)==null?void 0:B.devKey)||"0"),b=d((I=history==null?void 0:history.state)==null?void 0:I.location),$=d((w=history==null?void 0:history.state)==null?void 0:w.busName),f=[{name:"\u5C0F\u7535\u6D41\u4E0D\u5E73\u8861",color:"#aaa"},{name:"\u5927\u7535\u6D41\u4E0D\u5E73\u8861",color:"#3bbb00"},{name:"\u5927\u7535\u6D41\u4E0D\u5E73\u8861",color:"#ffc402"},{name:"\u5927\u7535\u6D41\u4E0D\u5E73\u8861",color:"#fa3333"}],g=[{name:"\u5C0F\u7535\u538B\u4E0D\u5E73\u8861",color:"#aaa"},{name:"\u5927\u7535\u538B\u4E0D\u5E73\u8861",color:"#3bbb00"},{name:"\u5927\u7535\u538B\u4E0D\u5E73\u8861",color:"#ffc402"},{name:"\u5927\u7535\u538B\u4E0D\u5E73\u8861",color:"#fa3333"}],i=L({pow_apparent_percent:0,pow_active_percent:0,cur_valueA:[],vol_value:[],imbalanceValueA:0,imbalanceValueB:0,colorIndex:0}),A=d({}),_=d({}),m=d({title:{text:"\u7535\u6D41\u8D8B\u52BF",left:"center"},tooltip:{trigger:"axis",formatter:function(e){let t=`\u8BB0\u5F55\u65F6\u95F4: ${e[0].name}<br/>`;const a=["A\u76F8\u7535\u6D41","B\u76F8\u7535\u6D41","C\u76F8\u7535\u6D41"];return e.forEach((u,n)=>{n<a.length&&u.seriesName&&(t+=`${a[n]}: ${u.value} A<br/>`)}),t}},grid:{left:"3%",right:"4%",bottom:"3%",containLabel:!0},yAxis:{type:"value",name:"\u7535\u6D41",axisLabel:{formatter:"{value} A"}},xAxis:{},series:[]}),v=d({title:{text:"\u7535\u538B\u8D8B\u52BF",left:"center"},tooltip:{trigger:"axis",formatter:function(e){let t=`\u8BB0\u5F55\u65F6\u95F4: ${e[0].name}<br/>`;const a=["A\u76F8\u7535\u538B","B\u76F8\u7535\u538B","C\u76F8\u7535\u538B"];return e.forEach((u,n)=>{n<a.length&&u.seriesName&&(t+=`${a[n]}: ${u.value} V<br/>`)}),t}},grid:{left:"3%",right:"4%",bottom:"3%",containLabel:!0},yAxis:{type:"value",name:"\u7535\u538B",axisLabel:{formatter:"{value} V"}},xAxis:{},series:[]});return E(async()=>{await(async()=>{try{const e=await j.getBoxIdAndLocation({devKey:x.value});e!=null?(b.value=e.location,h.value=e.boxId,$.value=e.busName):b.value=null}finally{}})(),(async()=>{const e=await S.getBoxBalanceDetail({devKey:x.value});if(e.cur_value){const t=e.cur_value;A.value={title:{text:"\u7535\u6D41\u997C\u5F62\u56FE",left:"center"},tooltip:{trigger:"item",formatter:"{b} : {c}"},series:[{type:"pie",radius:[20,120],center:["50%","50%"],roseType:"radius",itemStyle:{borderRadius:5},label:{show:!0,position:"inside",formatter:a=>`${a.value}A`,fontSize:14,fontWeight:"bold"},data:[{value:t[0],name:"A\u76F8\u7535\u6D41",itemStyle:{color:"#075F71"}},{value:t[1],name:"B\u76F8\u7535\u6D41",itemStyle:{color:"#119CB5"}},{value:t[2],name:"C\u76F8\u7535\u6D41",itemStyle:{color:"#45C0C9"}}]}]}}if(e.vol_value){const t=e.vol_value;_.value={title:{text:"\u7535\u538B\u997C\u5F62\u56FE",left:"center"},tooltip:{trigger:"item"},series:[{type:"pie",radius:["40%","80%"],avoidLabelOverlap:!1,itemStyle:{borderRadius:10,borderColor:"#fff",borderWidth:2},label:{show:!0,position:"inside",formatter:a=>`${a.value}V`,fontSize:14,fontWeight:"bold"},data:[{value:t[0],name:"A\u76F8\u7535\u538B",itemStyle:{color:"#E5B849"}},{value:t[1],name:"B\u76F8\u7535\u538B",itemStyle:{color:"#C8603A"}},{value:t[2],name:"C\u76F8\u7535\u538B",itemStyle:{color:"#AD3762"}}]}]}}i.imbalanceValueA=e.curUnbalance,i.imbalanceValueB=e.volUnbalance,i.colorIndex=e.color-1})(),(async()=>{const e=await S.getBoxBalanceTrend({boxId:h.value});if(e.length>0){const t=e.map(a=>a.dateTime);e[0].cur&&e[0].cur.length==1?(m.value.xAxis={type:"category",boundaryGap:!1,data:t},m.value.series=[{name:"A",type:"line",symbol:"none",data:e.map(a=>a.cur[0].curValue.toFixed(2))}]):e[0].cur&&e[0].cur.length==3&&(m.value.xAxis={type:"category",boundaryGap:!1,data:t},m.value.series=[{name:"A",type:"line",symbol:"none",data:e.map(a=>a.cur[0].curValue.toFixed(2))},{name:"B",type:"line",symbol:"none",data:e.map(a=>a.cur[1].curValue.toFixed(2))},{name:"C",type:"line",symbol:"none",data:e.map(a=>a.cur[2].curValue.toFixed(2))}]),e[0].vol&&e[0].vol.length==1?(v.value.xAxis={type:"category",boundaryGap:!1,data:t},v.value.series=[{name:"A",type:"line",symbol:"none",data:e.map(a=>a.vol[0].volValue.toFixed(1))}]):e[0].vol&&e[0].vol.length==3&&(v.value.xAxis={type:"category",boundaryGap:!1,data:t},v.value.series=[{name:"A",type:"line",symbol:"none",data:e.map(a=>a.vol[0].volValue.toFixed(1))},{name:"B",type:"line",symbol:"none",data:e.map(a=>a.vol[1].volValue.toFixed(1))},{name:"C",type:"line",symbol:"none",data:e.map(a=>a.vol[2].volValue.toFixed(1))}])}})()}),(e,t)=>{const a=W,u=T,n=U,c=K,V=q;return G(),N(R,null,[l(c,{class:"card",shadow:"never"},{header:r(()=>[l(a,{title:"\u7535\u6D41\u4E0D\u5E73\u8861"}),l(u,{size:"large"},{default:r(()=>[z(p(s(b)),1)]),_:1})]),default:r(()=>[o("div",X,[l(c,{class:"cardChilc",style:{margin:"0 10px"},shadow:"hover"},{default:r(()=>[o("div",M,[l(n,{options:s(A),height:300},null,8,["options"])])]),_:1}),l(c,{class:"cardChilc",shadow:"hover"},{default:r(()=>[o("div",O,[l(n,{options:s(m),height:300},null,8,["options"])])]),_:1}),l(c,{class:"cardChilc",shadow:"hover"},{default:r(()=>[o("div",{class:"box",style:y({borderColor:f[s(i).colorIndex].color})},[o("div",H,p(s(i).imbalanceValueA.toFixed(2))+"%",1),o("div",{class:"day",style:y({backgroundColor:f[s(i).colorIndex].color})},p(f[s(i).colorIndex].name),5),l(V,{class:"box-item",effect:"dark",content:"\u4E09\u76F8\u7535\u6D41\u4E0D\u5E73\u8861\uFF1A \u4E0D\u5E73\u8861\u5EA6%=\uFF08MAX\u76F8\u7535\u6D41-\u4E09\u76F8\u5E73\u5747\u7535\u6D41\uFF09/\u4E09\u76F8\u5E73\u5747\u7535\u6D41\xD7100%",placement:"right"},{default:r(()=>[o("div",{onClick:t[0]||(t[0]=F(()=>{},["prevent"])),class:"question"},"?")]),_:1})],4)]),_:1})])]),_:1}),l(c,{class:"card",shadow:"never"},{header:r(()=>[l(a,{title:"\u7535\u538B\u4E0D\u5E73\u8861"})]),default:r(()=>[o("div",J,[l(c,{class:"cardChilc",style:{margin:"0 10px"},shadow:"hover"},{default:r(()=>[o("div",P,[l(n,{options:s(_),height:300},null,8,["options"])])]),_:1}),l(c,{class:"cardChilc",shadow:"hover"},{default:r(()=>[o("div",Q,[l(n,{options:s(v),height:300},null,8,["options"])])]),_:1}),l(c,{class:"cardChilc",shadow:"hover"},{default:r(()=>[o("div",{class:"box",style:y({borderColor:g[s(i).colorIndex].color})},[o("div",Y,p(s(i).imbalanceValueB.toFixed(2))+"%",1),o("div",{class:"day",style:y({backgroundColor:g[s(i).colorIndex].color})},"\u7535\u538B\u4E0D\u5E73\u8861",4),l(V,{class:"box-item",effect:"dark",content:"\u4E09\u76F8\u7535\u538B\u4E0D\u5E73\u8861\u5EA6=( \u6700\u5927\u7535\u538B\u2212\u6700\u5C0F\u7535\u538B)/\u5E73\u5747\u7535\u538B\xD7100%",placement:"right"},{default:r(()=>[o("div",{onClick:t[1]||(t[1]=F(()=>{},["prevent"])),class:"question"},"?")]),_:1})],4)]),_:1})])]),_:1})],64)}}}),ee=D(Z,[["__scopeId","data-v-f3620d05"]]);export{ee as default};
