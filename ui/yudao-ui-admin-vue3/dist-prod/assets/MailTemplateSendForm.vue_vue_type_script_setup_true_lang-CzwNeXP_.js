import{d as F,e as i,f as M,o as c,n as v,w as r,k as u,a as t,l as g,s as S,c as U,F as q,p as R,m as T,O as j,Z as A,Q as O,A as Q,R as Z}from"./index-mcOGIq4g.js";import{_ as z}from"./Dialog.vue_vue_type_style_index_0_lang-BHwm1lq5.js";import{_ as B}from"./style.css_vue_type_style_index_0_src_true_lang-gbUSVHtw.js";import{g as D,s as E}from"./index-Dos6fkW3.js";import{u as G}from"./useMessage-CGTQbR_M.js";const H=F({name:"SystemMailTemplateSendForm",__name:"MailTemplateSendForm",setup(I,{expose:b}){const P=G(),p=i(!1),d=i(!1),a=i({content:"",params:{},mail:"",templateCode:"",templateParams:new Map}),f=M({mail:[{required:!0,message:"\u90AE\u7BB1\u4E0D\u80FD\u4E3A\u7A7A",trigger:"blur"}],templateCode:[{required:!0,message:"\u6A21\u7248\u7F16\u53F7\u4E0D\u80FD\u4E3A\u7A7A",trigger:"blur"}],templateParams:{}}),n=i();b({open:async s=>{p.value=!0,w(),d.value=!0;try{const e=await D(s);a.value.content=e.content,a.value.params=e.params,a.value.templateCode=e.code,a.value.templateParams=e.params.reduce((o,m)=>(o[m]="",o),{}),f.templateParams=e.params.reduce((o,m)=>(o[m]={required:!0,message:"\u53C2\u6570 "+m+" \u4E0D\u80FD\u4E3A\u7A7A",trigger:"blur"},o),{})}finally{d.value=!1}}});const V=async()=>{if(n&&await n.value.validate()){d.value=!0;try{const s=a.value,e=await E(s);e&&P.success("\u63D0\u4EA4\u53D1\u9001\u6210\u529F\uFF01\u53D1\u9001\u7ED3\u679C\uFF0C\u89C1\u53D1\u9001\u65E5\u5FD7\u7F16\u53F7\uFF1A"+e),p.value=!1}finally{d.value=!1}}},w=()=>{var s;a.value={content:"",params:{},mail:"",templateCode:"",templateParams:new Map},f.templateParams={},(s=n.value)==null||s.resetFields()};return(s,e)=>{const o=B,m=j,_=A,h=O,y=Q,C=z,k=Z;return c(),v(C,{modelValue:t(p),"onUpdate:modelValue":e[2]||(e[2]=l=>T(p)?p.value=l:null),title:"\u6D4B\u8BD5"},{footer:r(()=>[u(y,{disabled:t(d),type:"primary",onClick:V},{default:r(()=>[g("\u786E \u5B9A")]),_:1},8,["disabled"]),u(y,{onClick:e[1]||(e[1]=l=>p.value=!1)},{default:r(()=>[g("\u53D6 \u6D88")]),_:1})]),default:r(()=>[S((c(),v(h,{ref_key:"formRef",ref:n,model:t(a),rules:t(f),"label-width":"120px"},{default:r(()=>[u(m,{label:"\u6A21\u677F\u5185\u5BB9",prop:"content"},{default:r(()=>[u(o,{"model-value":t(a).content,height:"150px",readonly:""},null,8,["model-value"])]),_:1}),u(m,{label:"\u6536\u4EF6\u90AE\u7BB1",prop:"mail"},{default:r(()=>[u(_,{modelValue:t(a).mail,"onUpdate:modelValue":e[0]||(e[0]=l=>t(a).mail=l),placeholder:"\u8BF7\u8F93\u5165\u6536\u4EF6\u90AE\u7BB1"},null,8,["modelValue"])]),_:1}),(c(!0),U(q,null,R(t(a).params,l=>(c(),v(m,{key:l,label:"\u53C2\u6570 {"+l+"}",prop:"templateParams."+l},{default:r(()=>[u(_,{modelValue:t(a).templateParams[l],"onUpdate:modelValue":x=>t(a).templateParams[l]=x,placeholder:"\u8BF7\u8F93\u5165 "+l+" \u53C2\u6570"},null,8,["modelValue","onUpdate:modelValue","placeholder"])]),_:2},1032,["label","prop"]))),128))]),_:1},8,["model","rules"])),[[k,t(d)]])]),_:1},8,["modelValue"])}}});export{H as _};
