import{d as le,u as te,e as p,f as B,h as ie,aU as oe,o as h,n as W,w as o,j as s,t as m,a as n,k as t,l as u,m as se,s as z,c as D,F as ne,p as re,ax as de,I as P,q as V,A as pe,O as ue,c4 as me,_ as ce,Q as ye,D as ve,G as ge,R as fe,J as xe,K as he}from"./index-mcOGIq4g.js";import{_ as be}from"./CommonMenu-CxUjeIT-.js";import{E as we}from"./el-empty-Bl_qCsZJ.js";import{_ as ke}from"./index.vue_vue_type_script_setup_true_lang-DcNux-x9.js";import{E as _e}from"./el-text-BVz5ES0N.js";import{_ as Ee}from"./dn-BqCJhieo.js";import{I as k}from"./index-B_LT3qVv.js";import{_ as Ne}from"./_plugin-vue_export-helper-BCo6x5W8.js";import"./ContentWrap.vue_vue_type_script_setup_true_lang-BHQCcaX3.js";import"./el-card-FPJq94NZ.js";import"./NavTree-CcS5UKLK.js";import"./index-BFNvSS9e.js";const b=_=>(xe("data-v-65966286"),_=_(),he(),_),qe={class:"navInfo"},Ke={style:{"font-size":"14px","margin-top":"45px","margin-left":"10px"}},Ce=b(()=>s("div",null,[s("span",null,"\u7528\u80FD\u6700\u5927IP")],-1)),Le=b(()=>s("span",{class:"label"},"\u6628\u65E5\uFF1A",-1)),We={class:"value"},ze=b(()=>s("span",{class:"label"},"\u4E0A\u5468\uFF1A",-1)),De={class:"value"},Me=b(()=>s("span",{class:"label"},"\u4E0A\u6708\uFF1A",-1)),Se={class:"value"},Ie=b(()=>s("div",{class:"line"},null,-1)),Fe={class:"matrixContainer"},Ge={class:"content"},Te={class:"info",style:{"margin-left":"-10px"}},Ue=b(()=>s("img",{class:"count_img",alt:"",src:Ee,style:{"margin-left":"20%"}},null,-1)),Be={class:"room"},Pe=["onClick"],Ve=Ne(le({__name:"index",setup(_){const{push:A}=te(),E=p(!1),O=p(!0),M=p([]),w=p([]),v=p(0),j=p([]),g=p(void 0),S=p("\u65E0\u6570\u636E"),I=p("\u65E0\u6570\u636E"),F=p("\u65E0\u6570\u636E"),N=p([24,36,48,96]),r=B({company:void 0,pageNo:1,pageSize:24,pageTotal:0,boxDevKeyList:[],timeGranularity:""});B({company:void 0,pageNo:1,pageSize:-1,pageTotal:0,busDevKeyList:[],isDeleted:0});const q=i=>{r.timeGranularity=i,c(!0)},c=async(i=!1)=>{E.value=!0,i&&(r.pageNo=1);try{const e=await k.getEqPage({pageNo:r.pageNo,pageSize:r.pageSize,cabinetIds:O.value?null:j.value,runStatus:[],pduBox:0,company:r.company,boxDevKeyList:r.boxDevKeyList,timeGranularity:r.timeGranularity});e.list&&(w.value=e.list.map(l=>({id:l.id,devKey:l.devKey,roomName:l.roomName,location:l.location,local:l.location,busName:l.busName,yesterdayEq:l.yesterdayEq?l.yesterdayEq.toFixed(1):"0.0",lastWeekEq:l.lastWeekEq?l.lastWeekEq.toFixed(1):"0.0",lastMonthEq:l.lastMonthEq?l.lastMonthEq.toFixed(1):"0.0",status:l.runStatus,boxName:l.boxName})),r.pageTotal=e.total)}finally{E.value=!1}},G=()=>{g.value!=null&&g.value!=""?r.boxDevKeyList=[g.value]:r.boxDevKeyList=void 0,c(!0)},J=()=>{r.boxDevKeyList=void 0,c(!0)},K=p([]),Q=async(i,e)=>{if(i.length>7){var l=await k.boxFindKeys({key:i});let d=[];l.map(f=>{d.push({value:f})}),e(d)}else e(i?K.value.filter(R(i)):K.value)},R=i=>e=>e.value.toLowerCase().indexOf(i.toLowerCase())===0,T=i=>{v.value!=i&&(v.value=i,r.pageSize=i==0?24:15,c(!0))},H=i=>{if(i.length==0)return r.boxDevKeyList=null,void c();const e=[];var l=!1;i.forEach(d=>{d.type==7&&(e.push(d.unique),l=!0)}),r.boxDevKeyList=l?e:[-1],c(!0)},U=(i,e,l,d,f)=>{const x=f.devKey,C=f.busName;A({path:"/bus/boxmonitor/boxenergydetail",state:{roomId:i,id:e,roomName:l||"\u672A\u7ED1\u5B9A",boxName:d,devKey:x,busName:C}})};return ie(async()=>{K.value=await(async()=>(await k.devKeyList()).map(i=>({value:i})))()}),oe(()=>{(async()=>{const i=await k.getBoxMenu();M.value=i})(),c(),(async()=>{try{const i=await k.getEqMax();i&&i.forEach(e=>{e.id==0?S.value=e.devKey:e.id==1?I.value=e.devKey:e.id==2&&(F.value=e.devKey)})}finally{}})()}),(i,e)=>{const l=pe,d=ue,f=me,x=ce,C=ye,y=ve,L=_e,X=ge,Y=ke,Z=we,$=be,ee=fe;return h(),W($,{dataList:n(M),onCheck:H,navTitle:"\u63D2\u63A5\u7BB1\u7528\u80FD"},{NavInfo:o(()=>[s("div",qe,[s("div",Ke,[Ce,s("div",null,[Le,s("span",We,m(n(S)),1)]),s("div",null,[ze,s("span",De,m(n(I)),1)]),s("div",null,[Me,s("span",Se,m(n(F)),1)])]),Ie])]),ActionBar:o(()=>[t(C,{class:"-mb-15px",model:n(r),inline:!0,"label-width":"68px"},{default:o(()=>[t(d,{label:"\u7528\u80FD\u6392\u5E8F","label-width":"100px"},{default:o(()=>[t(l,{onClick:e[0]||(e[0]=a=>q("yesterday"))},{default:o(()=>[u(" \u6628\u65E5 ")]),_:1}),t(l,{onClick:e[1]||(e[1]=a=>q("lastWeek"))},{default:o(()=>[u(" \u4E0A\u5468 ")]),_:1}),t(l,{onClick:e[2]||(e[2]=a=>q("lastMonth"))},{default:o(()=>[u(" \u4E0A\u6708 ")]),_:1})]),_:1}),s("div",null,[t(d,{label:"\u7F51\u7EDC\u5730\u5740",prop:"devKey",style:{"margin-left":"80px"}},{default:o(()=>[t(f,{modelValue:n(g),"onUpdate:modelValue":e[3]||(e[3]=a=>se(g)?g.value=a:null),"fetch-suggestions":Q,clearable:"",class:"!w-160px",placeholder:"\u8BF7\u8F93\u5165\u7F51\u7EDC\u5730\u5740",onSelect:G},null,8,["modelValue"]),t(d,{style:{"margin-left":"5px","margin-right":"6px"}},{default:o(()=>[t(l,{onClick:G,style:{width:"70px"}},{default:o(()=>[t(x,{icon:"ep:search",class:"mr-5px"}),u(" \u641C\u7D22")]),_:1}),t(l,{onClick:J,style:{width:"70px"}},{default:o(()=>[t(x,{icon:"ep:refresh",class:"mr-5px"}),u(" \u91CD\u7F6E")]),_:1})]),_:1})]),_:1})]),t(d,{style:{"margin-left":"auto"}},{default:o(()=>[t(l,{onClick:e[4]||(e[4]=a=>{N.value=[24,36,48,96],T(0)}),type:n(v)?"":"primary"},{default:o(()=>[t(x,{icon:"ep:grid",style:{"margin-right":"8px"}}),u("\u9635\u5217\u6A21\u5F0F")]),_:1},8,["type"]),t(l,{onClick:e[5]||(e[5]=a=>{N.value=[15,25,30,50,100],n(r).pageSize=15,T(1)}),type:n(v)?"primary":""},{default:o(()=>[t(x,{icon:"ep:expand",style:{"margin-right":"8px"}}),u("\u8868\u683C\u6A21\u5F0F")]),_:1},8,["type"])]),_:1})]),_:1},8,["model"])]),Content:o(()=>[z((h(),D("div",null,[z(s("div",Fe,[(h(!0),D(ne,null,re(n(w),a=>(h(),D("div",{class:"item",key:a.key},[s("div",Ge,[s("div",Te,[s("div",null,"\u6628\u65E5\u7528\u80FD\uFF1A"+m(a.yesterdayEq)+"kW\xB7h",1),s("div",null,"\u4E0A\u5468\u7528\u80FD\uFF1A"+m(a.lastWeekEq)+"kW\xB7h",1),s("div",null,"\u4E0A\u6708\u7528\u80FD\uFF1A"+m(a.lastMonthEq)+"kW\xB7h",1)]),Ue]),s("div",Be,m(a.location),1),s("button",{class:"detail",onClick:de(ae=>U(a.roomId,a.id,a.roomName,a.boxName,a),["prevent"])},"\u8BE6\u60C5",8,Pe)]))),128))],512),[[P,n(v)==0&&n(w).length>0]]),z(t(X,{style:{width:"100%",height:"720px","margin-top":"-10px",overflow:"hidden","overflow-y":"auto"},data:n(w),border:!0},{default:o(()=>[t(y,{type:"index",width:"80px",label:"\u5E8F\u53F7",align:"center"}),t(y,{label:"\u4F4D\u7F6E","min-width":"150",align:"center",prop:"local"}),t(y,{label:"\u8BBE\u5907\u540D\u79F0",align:"center",prop:"boxName"}),t(y,{label:"\u7F51\u7EDC\u5730\u5740",align:"center",prop:"devKey","class-name":i.ip},null,8,["class-name"]),t(y,{label:"\u6628\u65E5\u7528\u80FD(kW\xB7h)","min-width":"80",align:"center",prop:"yesterdayEq"},{default:o(a=>[t(L,{"line-clamp":"2"},{default:o(()=>[u(m(a.row.yesterdayEq),1)]),_:2},1024)]),_:1}),t(y,{label:"\u4E0A\u5468\u7528\u80FD(kW\xB7h)","min-width":"80",align:"center",prop:"lastWeekEq"},{default:o(a=>[t(L,{"line-clamp":"2"},{default:o(()=>[u(m(a.row.lastWeekEq),1)]),_:2},1024)]),_:1}),t(y,{label:"\u4E0A\u6708\u7528\u80FD(kW\xB7h)","min-width":"80",align:"center",prop:"lastMonthEq"},{default:o(a=>[t(L,{"line-clamp":"2"},{default:o(()=>[u(m(a.row.lastMonthEq),1)]),_:2},1024)]),_:1}),t(y,{label:"\u64CD\u4F5C","min-width":"110",align:"center"},{default:o(a=>[a.row.status!=null&&a.row.status!=0?(h(),W(l,{key:0,link:"",type:"primary",onClick:ae=>U(a.row.roomId,a.row.id,a.row.roomName,a.row.boxName,a.row),style:{"background-color":"#409EFF",color:"#fff",border:"none",width:"100px",height:"30px"}},{default:o(()=>[u(" \u8BBE\u5907\u8BE6\u60C5 ")]),_:2},1032,["onClick"])):V("",!0)]),_:1})]),_:1},8,["data"]),[[P,n(v)==1]]),t(Y,{total:n(r).pageTotal,"page-size-arr":n(N),page:n(r).pageNo,"onUpdate:page":e[6]||(e[6]=a=>n(r).pageNo=a),limit:n(r).pageSize,"onUpdate:limit":e[7]||(e[7]=a=>n(r).pageSize=a),onPagination:e[8]||(e[8]=a=>c(!1))},null,8,["total","page-size-arr","page","limit"]),n(w).length==0&&n(v)==0?(h(),W(Z,{key:0,description:"\u6682\u65E0\u6570\u636E","image-size":300})):V("",!0)])),[[ee,n(E)]])]),_:1},8,["dataList"])}}}),[["__scopeId","data-v-65966286"]]);export{Ve as default};
