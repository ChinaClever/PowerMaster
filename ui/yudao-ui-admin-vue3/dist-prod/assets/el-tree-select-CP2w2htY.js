import{aC as B,ci as N,am as D,N as E,bT as x,g as y,ao as O,d as S,S as R,an as I,aj as T,bm as U,cj as M,bV as $,bS as F,bk as G,ck as J,e as _,f as j,h as P,ah as w,b0 as Q}from"./index-mcOGIq4g.js";const W=S({extends:R,setup(e,n){const d=R.setup(e,n);delete d.selectOptionClick;const u=I().proxy;return O(()=>{d.select.states.cachedOptions.get(u.value)||d.select.onOptionCreate(u)}),d},methods:{selectOptionClick(){this.$el.parentElement.click()}}});function H(e){return e||e===0}function L(e){return Array.isArray(e)&&e.length}function g(e){return Array.isArray(e)?e:H(e)?[e]:[]}function V(e,n,d,u,r){for(let s=0;s<e.length;s++){const h=e[s];if(n(h,s,e,r))return u?u(h,s,e,r):h;{const m=d(h);if(L(m)){const a=V(m,n,d,u,h);if(a)return a}}}}function q(e,n,d,u){for(let r=0;r<e.length;r++){const s=e[r];n(s,r,e,u);const h=d(s);L(h)&&q(h,n,d,s)}}const X=(e,{attrs:n,slots:d,emit:u},{select:r,tree:s,key:h})=>{T(()=>e.modelValue,()=>{e.showCheckbox&&O(()=>{const t=s.value;t&&!U(t.getCheckedKeys(),g(e.modelValue))&&t.setCheckedKeys(g(e.modelValue))})},{immediate:!0,deep:!0});const m=y(()=>({value:h.value,label:"label",children:"children",disabled:"disabled",isLeaf:"isLeaf",...e.props})),a=(t,l)=>{var c;const i=m.value[t];return F(i)?i(l,(c=s.value)==null?void 0:c.getNode(a("value",l))):l[i]},K=g(e.modelValue).map(t=>V(e.data||[],l=>a("value",l)===t,l=>a("children",l),(l,c,i,v)=>v&&a("value",v))).filter(t=>H(t)),b=y(()=>{if(!e.renderAfterExpand&&!e.lazy)return[];const t=[];return q(e.data.concat(e.cacheData),l=>{const c=a("value",l);t.push({value:c,currentLabel:a("label",l),isDisabled:a("disabled",l)})},l=>a("children",l)),t}),p=y(()=>b.value.reduce((t,l)=>({...t,[l.value]:l}),{}));return{...N(D(e),Object.keys(M.props)),...n,nodeKey:h,expandOnClickNode:y(()=>!e.checkStrictly&&e.expandOnClickNode),defaultExpandedKeys:y(()=>e.defaultExpandedKeys?e.defaultExpandedKeys.concat(K):K),renderContent:(t,{node:l,data:c,store:i})=>t(W,{value:a("value",c),label:a("label",c),disabled:a("disabled",c)},e.renderContent?()=>e.renderContent(t,{node:l,data:c,store:i}):d.default?()=>d.default({node:l,data:c,store:i}):void 0),filterNodeMethod:(t,l,c)=>e.filterNodeMethod?e.filterNodeMethod(t,l,c):t?new RegExp($(t),"i").test(a("label",l)||""):!0,onNodeClick:(t,l,c)=>{var i,v,k;if((i=n.onNodeClick)==null||i.call(n,t,l,c),!e.showCheckbox||!e.checkOnClickNode){if(e.showCheckbox||!e.checkStrictly&&!l.isLeaf)e.expandOnClickNode&&c.proxy.handleExpandIconClick();else if(!a("disabled",t)){const o=(v=r.value)==null?void 0:v.states.options.get(a("value",t));(k=r.value)==null||k.handleOptionSelect(o)}}},onCheck:(t,l)=>{if(!e.showCheckbox)return;const c=a("value",t),i=l.checkedKeys,v=e.multiple?g(e.modelValue).filter(o=>o in p.value&&!s.value.getNode(o)&&!i.includes(o)):[],k=i.concat(v);if(e.checkStrictly)u(x,e.multiple?k:k.includes(c)?c:void 0);else if(e.multiple)u(x,s.value.getCheckedKeys(!0));else{const o=V([t],C=>!L(a("children",C))&&!a("disabled",C),C=>a("children",C)),f=o?a("value",o):void 0,z=H(e.modelValue)&&!!V([t],C=>a("value",C)===e.modelValue,C=>a("children",C));u(x,f===e.modelValue||z?void 0:f)}O(()=>{var o;const f=g(e.modelValue);s.value.setCheckedKeys(f),(o=n.onCheck)==null||o.call(n,t,{checkedKeys:s.value.getCheckedKeys(),checkedNodes:s.value.getCheckedNodes(),halfCheckedKeys:s.value.getHalfCheckedKeys(),halfCheckedNodes:s.value.getHalfCheckedNodes()})})},cacheOptions:b}};var Y=S({props:{data:{type:Array,default:()=>[]}},setup(e){const n=G(J);return T(()=>e.data,()=>{var d;e.data.forEach(r=>{n.states.cachedOptions.has(r.value)||n.states.cachedOptions.set(r.value,r)});const u=((d=n.selectRef)==null?void 0:d.querySelectorAll("input"))||[];Array.from(u).includes(document.activeElement)||n.setSelected()},{flush:"post",immediate:!0}),()=>{}}}),A=Q(S({name:"ElTreeSelect",inheritAttrs:!1,props:{...E.props,...M.props,cacheData:{type:Array,default:()=>[]}},setup(e,n){const{slots:d,expose:u}=n,r=_(),s=_(),h=y(()=>e.nodeKey||e.valueKey||"value"),m=((p,{attrs:t,emit:l},{tree:c,key:i})=>{const v=B("tree-select"),k={...N(D(p),Object.keys(E.props)),...t,"onUpdate:modelValue":o=>l(x,o),valueKey:i,popperClass:y(()=>{const o=[v.e("popper")];return p.popperClass&&o.push(p.popperClass),o.join(" ")}),filterMethod:(o="")=>{p.filterMethod&&p.filterMethod(o),O(()=>{var f;(f=c.value)==null||f.filter(o)})},onVisibleChange:o=>{var f;(f=t.onVisibleChange)==null||f.call(t,o),p.filterable&&o&&k.filterMethod()}};return k})(e,n,{select:r,tree:s,key:h}),{cacheOptions:a,...K}=X(e,n,{select:r,tree:s,key:h}),b=j({});return u(b),P(()=>{Object.assign(b,{...N(s.value,["filter","updateKeyChildren","getCheckedNodes","setCheckedNodes","getCheckedKeys","setCheckedKeys","setChecked","getHalfCheckedNodes","getHalfCheckedKeys","getCurrentKey","getCurrentNode","setCurrentKey","setCurrentNode","getNode","remove","append","insertBefore","insertAfter"]),...N(r.value,["focus","blur"])})}),()=>w(E,j({...m,ref:p=>r.value=p}),{...d,default:()=>[w(Y,{data:a.value}),w(M,j({...K,ref:p=>s.value=p}))]})}}),[["__file","tree-select.vue"]]);A.install=e=>{e.component(A.name,A)};const Z=A;export{Z as E};
