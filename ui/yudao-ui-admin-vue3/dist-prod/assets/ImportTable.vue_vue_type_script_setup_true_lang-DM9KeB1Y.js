import{d as L,e as d,f as O,o as f,n as b,w as a,k as e,a as l,l as v,c as Q,F as Z,p as B,V as I,s as E,G as H,m as J,S as M,N as P,O as W,Z as X,_ as Y,A as $,Q as ee,D as ae,z as le,R as oe}from"./index-mcOGIq4g.js";import{_ as te}from"./Dialog.vue_vue_type_style_index_0_lang-BHwm1lq5.js";import{b as se,c as de}from"./index-CRRaXpPV.js";import{g as ne}from"./index-WFln17ZQ.js";import{u as ue}from"./useMessage-CGTQbR_M.js";const me=L({name:"InfraCodegenImportTable",__name:"ImportTable",emits:["success"],setup(re,{expose:S,emit:k}){const x=ue(),n=d(!1),_=d(!0),g=d([]),o=O({name:void 0,comment:void 0,dataSourceConfigId:0}),R=d(),m=d([]),u=async()=>{_.value=!0;try{g.value=await se(o)}finally{_.value=!1}},U=async()=>{o.name=void 0,o.comment=void 0,o.dataSourceConfigId=m.value[0].id,await u()};S({open:async()=>{m.value=await ne(),o.dataSourceConfigId=m.value[0].id,n.value=!0,await u()}});const y=()=>{n.value=!1,r.value=[]},C=d(),r=d([]),K=c=>{var t;(t=l(C))==null||t.toggleRowSelection(c)},D=c=>{r.value=c.map(t=>t.name)},F=async()=>{await de({dataSourceConfigId:o.dataSourceConfigId,tableNames:r.value}),x.success("\u5BFC\u5165\u6210\u529F"),N("success"),y()},N=k;return(c,t)=>{const T=M,j=P,i=W,h=X,V=Y,p=$,q=ee,w=ae,z=le,A=te,G=oe;return f(),b(A,{modelValue:l(n),"onUpdate:modelValue":t[3]||(t[3]=s=>J(n)?n.value=s:null),title:"\u5BFC\u5165\u8868",width:"800px"},{footer:a(()=>[e(p,{disabled:l(r).length===0,type:"primary",onClick:F},{default:a(()=>[v(" \u5BFC\u5165 ")]),_:1},8,["disabled"]),e(p,{onClick:y},{default:a(()=>[v("\u5173\u95ED")]),_:1})]),default:a(()=>[e(q,{ref_key:"queryFormRef",ref:R,inline:!0,model:l(o),"label-width":"68px"},{default:a(()=>[e(i,{label:"\u6570\u636E\u6E90",prop:"dataSourceConfigId"},{default:a(()=>[e(j,{modelValue:l(o).dataSourceConfigId,"onUpdate:modelValue":t[0]||(t[0]=s=>l(o).dataSourceConfigId=s),class:"!w-240px",placeholder:"\u8BF7\u9009\u62E9\u6570\u636E\u6E90"},{default:a(()=>[(f(!0),Q(Z,null,B(l(m),s=>(f(),b(T,{key:s.id,label:s.name,value:s.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),e(i,{label:"\u8868\u540D\u79F0",prop:"name"},{default:a(()=>[e(h,{modelValue:l(o).name,"onUpdate:modelValue":t[1]||(t[1]=s=>l(o).name=s),class:"!w-240px",clearable:"",placeholder:"\u8BF7\u8F93\u5165\u8868\u540D\u79F0",onKeyup:I(u,["enter"])},null,8,["modelValue"])]),_:1}),e(i,{label:"\u8868\u63CF\u8FF0",prop:"comment"},{default:a(()=>[e(h,{modelValue:l(o).comment,"onUpdate:modelValue":t[2]||(t[2]=s=>l(o).comment=s),class:"!w-240px",clearable:"",placeholder:"\u8BF7\u8F93\u5165\u8868\u63CF\u8FF0",onKeyup:I(u,["enter"])},null,8,["modelValue"])]),_:1}),e(i,null,{default:a(()=>[e(p,{onClick:u},{default:a(()=>[e(V,{class:"mr-5px",icon:"ep:search"}),v(" \u641C\u7D22 ")]),_:1}),e(p,{onClick:U},{default:a(()=>[e(V,{class:"mr-5px",icon:"ep:refresh"}),v(" \u91CD\u7F6E ")]),_:1})]),_:1})]),_:1},8,["model"]),e(z,null,{default:a(()=>[E((f(),b(l(H),{ref_key:"tableRef",ref:C,data:l(g),height:"260px",onRowClick:K,onSelectionChange:D},{default:a(()=>[e(w,{type:"selection",width:"55"}),e(w,{"show-overflow-tooltip":!0,label:"\u8868\u540D\u79F0",prop:"name"}),e(w,{"show-overflow-tooltip":!0,label:"\u8868\u63CF\u8FF0",prop:"comment"})]),_:1},8,["data"])),[[G,l(_)]])]),_:1})]),_:1},8,["modelValue"])}}});export{me as _};
