import{d as X,x as Y,e as m,f as Z,o as p,n as c,w as a,k as e,a as l,l as I,s as $,q as E,c as S,F,p as q,m as j,Z as G,O as H,E as J,z as K,S as M,N as P,Q as W,A as ee,R as le}from"./index-mcOGIq4g.js";import{_ as ae}from"./Dialog.vue_vue_type_style_index_0_lang-BHwm1lq5.js";import{E as se}from"./el-tree-select-CP2w2htY.js";import{a as de,D as ue}from"./dict-Cu4dALpk.js";import{C as A}from"./constants-D0aoFN3l.js";import{d as oe,h as te}from"./tree-Cts6wVCK.js";import{b as re}from"./index-DJVhKlgp.js";import{a as me}from"./index-DaJ-UTR5.js";import{a as pe,c as ne,u as ie}from"./index-CTA3ZZij.js";import{u as fe}from"./useMessage-CGTQbR_M.js";const ce=X({name:"SystemUserForm",__name:"UserForm",emits:["success"],setup(_e,{expose:C,emit:N}){const{t:V}=Y(),b=fe(),n=m(!1),k=m(""),i=m(!1),y=m(""),u=m({nickname:"",deptId:"",mobile:"",email:"",id:void 0,username:"",password:"",sex:void 0,postIds:[],remark:"",status:A.ENABLE,roleIds:[]}),R=Z({username:[{required:!0,message:"\u7528\u6237\u540D\u79F0\u4E0D\u80FD\u4E3A\u7A7A",trigger:"blur"}],nickname:[{required:!0,message:"\u7528\u6237\u6635\u79F0\u4E0D\u80FD\u4E3A\u7A7A",trigger:"blur"}],password:[{required:!0,message:"\u7528\u6237\u5BC6\u7801\u4E0D\u80FD\u4E3A\u7A7A",trigger:"blur"}],email:[{type:"email",message:"\u8BF7\u8F93\u5165\u6B63\u786E\u7684\u90AE\u7BB1\u5730\u5740",trigger:["blur","change"]}],mobile:[{pattern:/^(?:(?:\+|00)86)?1(?:3[\d]|4[5-79]|5[0-35-9]|6[5-7]|7[0-8]|8[\d]|9[189])\d{8}$/,message:"\u8BF7\u8F93\u5165\u6B63\u786E\u7684\u624B\u673A\u53F7\u7801",trigger:"blur"}]}),v=m(),g=m([]),w=m([]);C({open:async(o,d)=>{if(n.value=!0,k.value=V("action."+o),y.value=o,D(),d){i.value=!0;try{u.value=await pe(d)}finally{i.value=!1}}g.value=te(await me()),w.value=await re()}});const B=N,L=async()=>{if(v&&await v.value.validate()){i.value=!0;try{const o=u.value;y.value==="create"?(await ne(o),b.success(V("common.createSuccess"))):(await ie(o),b.success(V("common.updateSuccess"))),n.value=!1,B("success")}finally{i.value=!1}}},D=()=>{var o;u.value={nickname:"",deptId:"",mobile:"",email:"",id:void 0,username:"",password:"",sex:void 0,postIds:[],remark:"",status:A.ENABLE,roleIds:[]},(o=v.value)==null||o.resetFields()};return(o,d)=>{const f=G,t=H,r=J,z=se,_=K,h=M,U=P,O=W,x=ee,Q=ae,T=le;return p(),c(Q,{modelValue:l(n),"onUpdate:modelValue":d[10]||(d[10]=s=>j(n)?n.value=s:null),title:l(k)},{footer:a(()=>[e(x,{disabled:l(i),type:"primary",onClick:L},{default:a(()=>[I("\u786E \u5B9A")]),_:1},8,["disabled"]),e(x,{onClick:d[9]||(d[9]=s=>n.value=!1)},{default:a(()=>[I("\u53D6 \u6D88")]),_:1})]),default:a(()=>[$((p(),c(O,{ref_key:"formRef",ref:v,model:l(u),rules:l(R),"label-width":"80px"},{default:a(()=>[e(_,null,{default:a(()=>[e(r,{span:12},{default:a(()=>[e(t,{label:"\u7528\u6237\u6635\u79F0",prop:"nickname"},{default:a(()=>[e(f,{modelValue:l(u).nickname,"onUpdate:modelValue":d[0]||(d[0]=s=>l(u).nickname=s),placeholder:"\u8BF7\u8F93\u5165\u7528\u6237\u6635\u79F0"},null,8,["modelValue"])]),_:1})]),_:1}),e(r,{span:12},{default:a(()=>[e(t,{label:"\u5F52\u5C5E\u90E8\u95E8",prop:"deptId"},{default:a(()=>[e(z,{modelValue:l(u).deptId,"onUpdate:modelValue":d[1]||(d[1]=s=>l(u).deptId=s),data:l(g),props:l(oe),"check-strictly":"","node-key":"id",placeholder:"\u8BF7\u9009\u62E9\u5F52\u5C5E\u90E8\u95E8"},null,8,["modelValue","data","props"])]),_:1})]),_:1})]),_:1}),e(_,null,{default:a(()=>[e(r,{span:12},{default:a(()=>[e(t,{label:"\u624B\u673A\u53F7\u7801",prop:"mobile"},{default:a(()=>[e(f,{modelValue:l(u).mobile,"onUpdate:modelValue":d[2]||(d[2]=s=>l(u).mobile=s),maxlength:"11",placeholder:"\u8BF7\u8F93\u5165\u624B\u673A\u53F7\u7801"},null,8,["modelValue"])]),_:1})]),_:1}),e(r,{span:12},{default:a(()=>[e(t,{label:"\u90AE\u7BB1",prop:"email"},{default:a(()=>[e(f,{modelValue:l(u).email,"onUpdate:modelValue":d[3]||(d[3]=s=>l(u).email=s),maxlength:"50",placeholder:"\u8BF7\u8F93\u5165\u90AE\u7BB1"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),e(_,null,{default:a(()=>[e(r,{span:12},{default:a(()=>[l(u).id===void 0?(p(),c(t,{key:0,label:"\u7528\u6237\u540D\u79F0",prop:"username"},{default:a(()=>[e(f,{modelValue:l(u).username,"onUpdate:modelValue":d[4]||(d[4]=s=>l(u).username=s),placeholder:"\u8BF7\u8F93\u5165\u7528\u6237\u540D\u79F0"},null,8,["modelValue"])]),_:1})):E("",!0)]),_:1}),e(r,{span:12},{default:a(()=>[l(u).id===void 0?(p(),c(t,{key:0,label:"\u7528\u6237\u5BC6\u7801",prop:"password"},{default:a(()=>[e(f,{modelValue:l(u).password,"onUpdate:modelValue":d[5]||(d[5]=s=>l(u).password=s),placeholder:"\u8BF7\u8F93\u5165\u7528\u6237\u5BC6\u7801","show-password":"",type:"password"},null,8,["modelValue"])]),_:1})):E("",!0)]),_:1})]),_:1}),e(_,null,{default:a(()=>[e(r,{span:12},{default:a(()=>[e(t,{label:"\u7528\u6237\u6027\u522B"},{default:a(()=>[e(U,{modelValue:l(u).sex,"onUpdate:modelValue":d[6]||(d[6]=s=>l(u).sex=s),placeholder:"\u8BF7\u9009\u62E9"},{default:a(()=>[(p(!0),S(F,null,q(l(de)(l(ue).SYSTEM_USER_SEX),s=>(p(),c(h,{key:s.value,label:s.label,value:s.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1}),e(r,{span:12},{default:a(()=>[e(t,{label:"\u5C97\u4F4D"},{default:a(()=>[e(U,{modelValue:l(u).postIds,"onUpdate:modelValue":d[7]||(d[7]=s=>l(u).postIds=s),multiple:"",placeholder:"\u8BF7\u9009\u62E9"},{default:a(()=>[(p(!0),S(F,null,q(l(w),s=>(p(),c(h,{key:s.id,label:s.name,value:s.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1}),e(_,null,{default:a(()=>[e(r,{span:24},{default:a(()=>[e(t,{label:"\u5907\u6CE8"},{default:a(()=>[e(f,{modelValue:l(u).remark,"onUpdate:modelValue":d[8]||(d[8]=s=>l(u).remark=s),placeholder:"\u8BF7\u8F93\u5165\u5185\u5BB9",type:"textarea"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1})]),_:1},8,["model","rules"])),[[T,l(i)]])]),_:1},8,["modelValue","title"])}}});export{ce as _};
