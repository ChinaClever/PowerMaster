import{d as G,e as p,f as K,o as z,c as O,k as e,w as t,j as r,s as Q,n as $,a as i,ax as q,l as c,t as S,F as H,b8 as W,aZ as X,_ as Y,Z as ee,O as ae,A as le,ba as te,Q as ie,D as ne,aR as oe,G as se,R as re,J as pe,K as de}from"./index-mcOGIq4g.js";import{_ as me}from"./CommonMenu-CxUjeIT-.js";import{_ as ue}from"./index.vue_vue_type_script_setup_true_lang-DcNux-x9.js";import{E as ce,a as fe}from"./el-menu-item-D1a8KxH6.js";import{A as v}from"./index-D7J3j60l.js";import{_ as ge}from"./AlarmForm.vue_vue_type_script_setup_true_lang-CiaHKw_f.js";import{u as he}from"./useMessage-CGTQbR_M.js";import{_ as be}from"./_plugin-vue_export-helper-BCo6x5W8.js";import"./ContentWrap.vue_vue_type_script_setup_true_lang-BHQCcaX3.js";import"./el-card-FPJq94NZ.js";import"./NavTree-CcS5UKLK.js";import"./index-BFNvSS9e.js";import"./Dialog.vue_vue_type_style_index_0_lang-BHwm1lq5.js";const w=b=>(pe("data-v-6b33697a"),b=b(),de(),b),ye={class:"filterList"},_e=w(()=>r("span",null,"\u672A\u5904\u7406\u8B66\u544A",-1)),ve=w(()=>r("span",null,"\u5DF2\u6302\u8D77\u8B66\u544A",-1)),we=w(()=>r("span",null,"\u5DF2\u786E\u8BA4\u8B66\u544A",-1)),Ve=w(()=>r("span",null,"\u5386\u53F2\u8B66\u544A",-1)),Ae={class:"table-desc"},Ce={class:"tooltip-width"},xe=be(G({__name:"Alarm",setup(b){const E=he(),x=p(),R=p(),d=p(""),N=p(!1),T=p([]),f=p([0]),g=p(!1),l=K({search:"",pageNo:1,pageSize:10,a:0,pageTotal:8,id:"",openEmail:!1,openVoice:!0,openMessage:!1}),V=async()=>{g.value=!0;try{await v.saveAlarmConfig({id:l.id,mailAlarm:l.openEmail?1:0,voiceAlarm:l.openVoice?1:0,smsAlarm:l.openMessage?1:0})&&E.success("\u914D\u7F6E\u4FEE\u6539\u6210\u529F")}finally{g.value=!1}},y=async(o=!1)=>{N.value=!0,o&&(l.pageNo=1);try{const a=await v.getAlarmRecord({pageNo:l.pageNo,pageSize:l.pageSize,a:0,status:f.value,likeName:l.search});a.list&&(T.value=a.list,l.pageTotal=a.total)}finally{N.value=!1}},A=o=>{W.prompt("\u8BF7\u8F93\u5165\u539F\u56E0\uFF1A",`${["\u6302\u8D77","\u786E\u8BA4","\u7ED3\u675F"][o-1]}\u544A\u8B66`,{confirmButtonText:"\u786E\u5B9A",cancelButtonText:"\u53D6\u6D88",inputErrorMessage:"\u8BF7\u8F93\u5165"}).then(({value:a})=>{v.saveAlarmRecord({id:d.value,status:o,confirmReason:a}).then(()=>{X({type:"success",message:"\u6210\u529F"})})})},U=o=>{o&&(d.value=o.id)},M=o=>{f.value.splice(0,1,+o),d.value="",y(!0)},k=o=>{x.value.open(o)},D=()=>{};return y(),(async()=>{g.value=!0;try{const o=await v.getAlarmConfig({});o&&(l.id=o.id,l.openEmail=!!o.mailAlarm,l.openVoice=!!o.voiceAlarm,l.openMessage=!!o.smsAlarm)}finally{g.value=!1}})(),(o,a)=>{const h=Y,_=ce,B=fe,J=ee,m=ae,u=le,C=te,F=ie,s=ne,I=oe,L=se,P=ue,Z=me,j=re;return z(),O(H,null,[e(Z,{showNavTree:!1,navTitle:"\u544A\u8B66"},{NavInfo:t(()=>[r("div",ye,[e(B,{"default-active":"0",onSelect:M},{default:t(()=>[e(_,{index:"0"},{default:t(()=>[e(h,{size:18,icon:"ep:bell"}),_e]),_:1}),e(_,{index:"1"},{default:t(()=>[e(h,{size:18,icon:"ep:bell"}),ve]),_:1}),e(_,{index:"2"},{default:t(()=>[e(h,{size:18,icon:"ep:bell"}),we]),_:1}),e(_,{index:"3"},{default:t(()=>[e(h,{size:18,icon:"ep:bell"}),Ve]),_:1})]),_:1})])]),ActionBar:t(()=>[Q((z(),$(F,{class:"-mb-15px",model:i(l),inline:!0,"label-width":"68px",onSubmit:a[11]||(a[11]=q(()=>{},["prevent"]))},{default:t(()=>[r("div",null,[e(m,{label:"","label-width":"100"},{default:t(()=>[e(J,{modelValue:i(l).search,"onUpdate:modelValue":a[0]||(a[0]=n=>i(l).search=n),placeholder:"\u641C\u7D22\u544A\u8B66",clearable:"",class:"!w-170px",height:"35"},null,8,["modelValue"])]),_:1}),e(m,null,{default:t(()=>[e(u,{style:{"margin-left":"12px"},modelValue:i(l).search,"onUpdate:modelValue":a[1]||(a[1]=n=>i(l).search=n),modelModifiers:{trim:!0},type:"primary",onClick:a[2]||(a[2]=n=>y(!0))},{default:t(()=>[e(h,{icon:"ep:search"}),c("\u641C\u7D22")]),_:1},8,["modelValue"])]),_:1}),e(m,{label:"\u53D1\u9001\u90AE\u4EF6","label-width":"90"},{default:t(()=>[e(C,{modelValue:i(l).openEmail,"onUpdate:modelValue":a[3]||(a[3]=n=>i(l).openEmail=n),onChange:V},null,8,["modelValue"])]),_:1}),e(m,{label:"\u58F0\u97F3\u62A5\u8B66","label-width":"90"},{default:t(()=>[e(C,{modelValue:i(l).openVoice,"onUpdate:modelValue":a[4]||(a[4]=n=>i(l).openVoice=n),onChange:V},null,8,["modelValue"])]),_:1}),e(m,{label:"\u77ED\u4FE1\u62A5\u8B66","label-width":"90"},{default:t(()=>[e(C,{modelValue:i(l).openMessage,"onUpdate:modelValue":a[5]||(a[5]=n=>i(l).openMessage=n),onChange:V},null,8,["modelValue"])]),_:1})]),e(m,{style:{"margin-left":"auto"}},{default:t(()=>[e(u,{type:"primary",onClick:a[6]||(a[6]=n=>k("phone"))},{default:t(()=>[c("\u624B\u673A\u914D\u7F6E")]),_:1}),e(u,{type:"primary",onClick:a[7]||(a[7]=n=>k("mail"))},{default:t(()=>[c("\u90AE\u7BB1\u914D\u7F6E")]),_:1}),e(u,{type:"primary",disabled:!i(d)||i(f).includes(3),onClick:a[8]||(a[8]=n=>A(1))},{default:t(()=>[c("\u6302\u8D77")]),_:1},8,["disabled"]),e(u,{type:"primary",disabled:!i(d)||i(f).includes(3),onClick:a[9]||(a[9]=n=>A(2))},{default:t(()=>[c("\u786E\u8BA4")]),_:1},8,["disabled"]),e(u,{type:"primary",disabled:!i(d)||i(f).includes(3),onClick:a[10]||(a[10]=n=>A(3))},{default:t(()=>[c("\u7ED3\u675F")]),_:1},8,["disabled"])]),_:1})]),_:1},8,["model"])),[[j,i(g)]])]),Content:t(()=>[e(L,{ref_key:"multipleTableRef",ref:R,data:i(T),"highlight-current-row":"",style:{width:"100%"},stripe:!0,border:!0,onCurrentChange:U},{default:t(()=>[e(s,{type:"index",width:"80",label:"\u5E8F\u53F7",align:"center"}),e(s,{property:"devPosition",label:"\u533A\u57DF","min-width":"100",align:"center"}),e(s,{property:"devName",label:"\u8BBE\u5907","min-width":"100",align:"center"}),e(s,{property:"alarmLevelDesc",label:"\u544A\u8B66\u7B49\u7EA7","min-width":"100",align:"center"}),e(s,{property:"alarmTypeDesc",label:"\u544A\u8B66\u7C7B\u578B","min-width":"100",align:"center"}),e(s,{property:"alarmDesc",label:"\u63CF\u8FF0","min-width":"120",align:"center"},{default:t(n=>[e(I,{placement:"right"},{content:t(()=>[r("div",Ce,S(n.row.alarmDesc),1)]),default:t(()=>[r("div",Ae,S(n.row.alarmDesc),1)]),_:2},1024)]),_:1}),e(s,{property:"startTime",label:"\u5F00\u59CB\u65F6\u95F4","min-width":"100",align:"center"}),e(s,{property:"endTime",label:"\u7ED3\u675F\u65F6\u95F4","min-width":"100",align:"center"}),e(s,{property:"finishReason",label:"\u7ED3\u675F\u539F\u56E0","min-width":"100",align:"center"}),e(s,{property:"confirmReason",label:"\u786E\u8BA4\u539F\u56E0","min-width":"100",align:"center"})]),_:1},8,["data"]),e(P,{total:i(l).pageTotal,page:i(l).pageNo,"onUpdate:page":a[12]||(a[12]=n=>i(l).pageNo=n),limit:i(l).pageSize,"onUpdate:limit":a[13]||(a[13]=n=>i(l).pageSize=n),onPagination:a[14]||(a[14]=n=>y(!1))},null,8,["total","page","limit"])]),_:1}),e(ge,{ref_key:"alarmForm",ref:x,onSuccess:D},null,512)],64)}}}),[["__scopeId","data-v-6b33697a"]]);export{xe as default};
